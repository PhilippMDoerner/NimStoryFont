(self.webpackChunknimstoryfont_gui=self.webpackChunknimstoryfont_gui||[]).push([[6963],{"./node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{t:()=>shareReplay});var _ReplaySubject__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js"),_share__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/share.js");function shareReplay(configOrBufferSize,windowTime,scheduler){var _a,_b,_c,bufferSize,refCount=!1;return configOrBufferSize&&"object"==typeof configOrBufferSize?(_a=configOrBufferSize.bufferSize,bufferSize=void 0===_a?1/0:_a,_b=configOrBufferSize.windowTime,windowTime=void 0===_b?1/0:_b,refCount=void 0!==(_c=configOrBufferSize.refCount)&&_c,scheduler=configOrBufferSize.scheduler):bufferSize=null!=configOrBufferSize?configOrBufferSize:1/0,(0,_share__WEBPACK_IMPORTED_MODULE_0__.u)({connector:function(){return new _ReplaySubject__WEBPACK_IMPORTED_MODULE_1__.m(bufferSize,windowTime,scheduler)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:refCount})}},"./src/app/_services/article/article.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>ArticleService});var tslib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_common_http__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/common/fesm2022/module-CBsxN_3E.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),src_environments_environment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/environments/environment.ts"),_routing_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/app/_services/routing.service.ts");let ArticleService=class ArticleService{constructor(routingService,http){this.routingService=routingService,this.http=http,this.apiUrl=src_environments_environment__WEBPACK_IMPORTED_MODULE_0__.c.apiUrl,this.recentlyUpdatedUrl=`${this.apiUrl}/recentupdates`,this.searchUrl=`${this.apiUrl}/search`}getRecentlyUpdatedArticle(campaign,pageNumber){return null==pageNumber&&(pageNumber=0),this.http.get(`${this.recentlyUpdatedUrl}/${campaign}/${pageNumber}`).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.T)(entries=>entries.map(entry=>this.parseOverviewEntity(entry))))}getGlobalSearchArticle(searchString){return this.http.get(`${this.searchUrl}/${searchString}`).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.T)(searchResponse=>{const searchArticleObjects=searchResponse.articles.map(item=>this.parseOverviewEntity(item));return searchResponse.articles=searchArticleObjects,searchResponse}))}getCampaignSearchArticle(campaign,searchString){return this.http.get(`${this.searchUrl}/${campaign}/${searchString}`).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.T)(searchResponse=>{const searchArticleObjects=searchResponse.articles.map(item=>this.parseOverviewEntity(item));return searchResponse.articles=searchArticleObjects,searchResponse}))}searchArticlesKind(campaign,searchTerm,articleKind){return this.http.get(`${this.searchUrl}/${campaign}/${articleKind}/${searchTerm}`).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.T)(response=>response.map(item=>this.parseOverviewEntity(item))))}readArticle(articleId,articleKind){return this.http.get(`${this.searchUrl}/single/${articleKind}/${articleId}`).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.T)(resp=>this.parseOverviewEntity(resp)))}parseOverviewEntity(data){return{...data,getAbsoluteRouterUrl:this.generateUrlCallback(data)}}generateUrlCallback(data){const articleType=data.article_type,params={campaign:data.campaign_details.name};let routeName="";switch(articleType){case"character":params.name=data.name,routeName="character";break;case"creature":params.name=data.name,routeName="creature";break;case"diaryentry":params.session_number=data.session_details.session_number,params.isMainSession=data.session_details.is_main_session_int,params.authorName=data.author_details.name,routeName="diaryentry";break;case"encounter":params.session_number=data.diaryentry_details.session_number,params.isMainSession=data.diaryentry_details.is_main_session,params.authorName=data.diaryentry_details.author_name,params.encounterTitle=data.title,routeName="diaryentry-encounter";break;case"item":params.name=data.name,routeName="item";break;case"location":params.name=data.name,params.parent_name=data.parent_location_details.name,routeName="location";break;case"organization":params.name=data.name,routeName="organization";break;case"quest":params.name=data.name,routeName="quest";break;case"sessionaudio":params.isMainSession=data.session_details.is_main_session_int,params.sessionNumber=data.session_details.session_number,routeName="sessionaudio";break;case"session":routeName="sessions";break;case"map":case"mapmarker":params.name=data.name,routeName="map";break;case"timestamp":routeName="default-map";break;case"spell":params.name=data.name,routeName="spell";break;case"rules":params.name=data.name,routeName="rule"}return()=>this.routingService.getRoutePath(routeName,params)}static#_=this.ctorParameters=()=>[{type:_routing_service__WEBPACK_IMPORTED_MODULE_1__.O},{type:_angular_common_http__WEBPACK_IMPORTED_MODULE_3__.Qq}]};ArticleService=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__._qm)({providedIn:"root"})],ArticleService)},"./src/app/_services/online.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{D:()=>OnlineService});var tslib__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/merge.js"),rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js"),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js");let OnlineService=class OnlineService{constructor(){this.isInBrowser=!!window,this.online$=this.isInBrowser?(0,rxjs__WEBPACK_IMPORTED_MODULE_0__.h)((0,rxjs__WEBPACK_IMPORTED_MODULE_1__.R)(window,"online").pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_2__.T)(()=>!0)),(0,rxjs__WEBPACK_IMPORTED_MODULE_1__.R)(window,"offline").pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_2__.T)(()=>!1))).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.Z)(window.navigator.onLine)):(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.of)(!0)}};OnlineService=(0,tslib__WEBPACK_IMPORTED_MODULE_5__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__._qm)({providedIn:"root"})],OnlineService)},"./src/app/_services/pwa.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>PwaService});var tslib__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js"),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),_online_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/app/_services/online.service.ts");let PwaService=class PwaService{constructor(){this.destroyRef=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.abz),this.onlineService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.WQX)(_online_service__WEBPACK_IMPORTED_MODULE_0__.D),this.installEvent=void 0,this.installEvent$=new rxjs__WEBPACK_IMPORTED_MODULE_2__.m(1),this.canInstall$=(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.z)({online:this.onlineService.online$,isInstallable:this.installEvent$.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.T)(event=>null!=event))}).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.T)(({online,isInstallable})=>online&&isInstallable))}showInstallPrompt(){this.installEvent&&(this.installEvent.prompt(),this.installEvent.userChoice.then(({outcome})=>{"accepted"===outcome&&(this.installEvent$.next(void 0),this.installEvent=void 0)}))}storeInstallEvent(event){this.installEvent=event,this.installEvent$.next(event)}};PwaService=(0,tslib__WEBPACK_IMPORTED_MODULE_5__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__._qm)({providedIn:"root"})],PwaService)},"./src/app/_services/swipe.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{I:()=>SwipeService});var tslib__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/withLatestFrom.js"),rxjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),_app_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/app/app.constants.ts"),_screen_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/app/_services/screen.service.ts");let SwipeService=class SwipeService{constructor(){this.screenService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_screen_service__WEBPACK_IMPORTED_MODULE_1__.i)}getSwipeEvents(elementRef){const touchStart$=(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.R)(elementRef.nativeElement,"touchstart",{passive:!0}).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.p)(()=>this.screenService.isMobile()),(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.p)(event=>this.isInIgnoreZone(event)),(0,rxjs__WEBPACK_IMPORTED_MODULE_5__.t)(1));return(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.R)(elementRef.nativeElement,"touchend",{passive:!0}).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.p)(()=>this.screenService.isMobile()),(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.p)(event=>this.isInIgnoreZone(event))).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_6__.E)(touchStart$),(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.p)(([touchEnd,touchStart])=>{const swipeStartY=touchStart.touches[0]?.clientY,swipeEndY=touchEnd.changedTouches[0]?.clientY;return Math.abs(swipeStartY-swipeEndY)<_app_constants__WEBPACK_IMPORTED_MODULE_0__.ds}),(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.T)(([touchEnd,touchStart])=>{const swipeStartX=touchStart.touches[0]?.clientX,swipeEndX=touchEnd.changedTouches[0]?.clientX;return swipeEndX-swipeStartX}))}isInIgnoreZone(event){const target=event.target;if(!(target instanceof Element))return!0;return!(null!=target.closest("[data-swipe-ignore]"))}};SwipeService=(0,tslib__WEBPACK_IMPORTED_MODULE_8__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_9__._qm)({providedIn:"root"})],SwipeService)},"./src/app/_services/utils/campaign.mock.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_B:()=>dummyCampaigns,jr:()=>dummyCampaign,mE:()=>dummyStatistics});const dummyCampaigns=[{pk:1,name:"Aldrune",subtitle:"A campaign made by Samuel Day and recorded by Philipp Dörner<br>through the eyes of Relentless",background_image:"/media/campaign_backgrounds/bg.jpg",is_deactivated:!1,has_audio_recording_permission:!0,icon:"/media/campaign_icons/favicon-128x128.png",default_map:1,default_map_details:{icon:"map",image:"pic05_sMT2d6M.jpg",name:"Aldrune",id:1},duration:{start_date:"2020-04-07T00:00:00.000000Z",last_date:"2023-04-11T00:00:00.000000Z"}},{pk:2,name:"Jōzai Corp",subtitle:"Welcome to Jōzai Corp, please enjoy your employment.",background_image:"/media/campaign_backgrounds/shanghai_city_snlaYDd.jpg",is_deactivated:!1,has_audio_recording_permission:!1,icon:"/media/campaign_icons/icon.png",default_map:void 0,default_map_details:void 0,duration:{start_date:"2022-01-15T00:00:00.000000Z",last_date:"2022-02-19T00:00:00.000000Z"}}],dummyStatistics={character_count:265,item_count:142,location_count:229,creature_count:42,diaryentry_count:101,encounter_count:954,organization_count:46,quest_count:69,quote_count:203,session_audio_count:69,timestamp_count:1121,map_count:7,marker_count:136,spell_count:22,session_count:90,rule_count:17},dummyCampaign={name:"Aldrune",subtitle:"A campaign for testing",pk:1,background_image:"/assets/default_images/audio_pic_default.webp",icon:"https://www.aldrune.com/media/campaign_icons/favicon-128x128.png",default_map:123,default_map_details:{id:123,name:"Default Map",icon:"plus",image:"blub.jpg"},is_deactivated:!1,has_audio_recording_permission:!0,members:[{username:"isofruit",password:"password1",pk:1,api_permissions:["permission1","permission2"],groups:[1,2],group_details:[{name:"group1",pk:1},{name:"group2",pk:2}],is_staff:!0,is_superuser:!1,email:"user1@example.com",is_active:!0},{username:"user2",password:"password2",pk:2,api_permissions:["permission3","permission4"],groups:[1,3],group_details:[{name:"group1",pk:1},{name:"group3",pk:3}],is_staff:!1,is_superuser:!1,email:"user2@example.com",is_active:!0}],admins:[{username:"admin",password:"adminpassword",pk:3,api_permissions:["permission1","permission2","permission3","permission4"],groups:[1,2,3],group_details:[{name:"group1",pk:1},{name:"group2",pk:2},{name:"group3",pk:3}],is_staff:!0,is_superuser:!0,email:"admin@example.com",is_active:!0},{username:"user3",password:"password3",pk:4,api_permissions:["permission1"],groups:[1],group_details:[{name:"group1",pk:1}],is_staff:!1,is_superuser:!1,email:"user3@example.com",is_active:!0}],guests:[{username:"user4",password:"password4",pk:5,api_permissions:["permission2","permission3"],groups:[2,3],group_details:[{name:"group2",pk:2},{name:"group3",pk:3}],is_staff:!1,is_superuser:!1,email:"user4@example.com",is_active:!0},{username:"user5",password:"password5",pk:6,api_permissions:["permission4"],groups:[3],group_details:[{name:"group3",pk:3}],is_staff:!1,is_superuser:!1,email:"user5@example.com",is_active:!0}],member_group_name:"Members",admin_group_name:"Admins",guest_group_name:"Guests",emptySearchResponses:[{id:1,text:"Empty response 1",campaign:1},{id:2,text:"Empty response 2",campaign:1}]}},"./src/app/_services/utils/token.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{B:()=>TokenService});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),module_CBsxN_3E=__webpack_require__("./node_modules/@angular/common/fesm2022/module-CBsxN_3E.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs");const CampaignRoles=["member","admin","guest","globalguest","globalmember"];var environment=__webpack_require__("./src/environments/environment.ts"),logging=__webpack_require__("./src/utils/logging.ts");let TokenService=class TokenService{static#_=this.USER_DATA_KEY="user_data";constructor(http){this.http=http,this.apiUrl=environment.c.apiUrl,this.jwtTokenUrl=`${this.apiUrl}/token`,this.refreshTokenUrl=`${this.jwtTokenUrl}/refresh`,this.ID_IDENTIFIER_PREFIX="id_"}login(loginData){return this.http.post(this.jwtTokenUrl,loginData)}logout(){return this.http.get(`${this.jwtTokenUrl}/logout`)}refreshUserData(){return(0,logging.R)(this.refreshUserData.name,this.refreshTokenUrl),this.http.post(this.refreshTokenUrl,{})}fetchAuthData(){return(0,logging.R)(this.fetchAuthData.name),this.http.get(`${this.apiUrl}/authdata`)}patchMyPassword(newPassword,oldPassword){return this.http.patch(`${this.apiUrl}/authdata/patch-password`,{password:newPassword,old_password:oldPassword})}getCampaignRole(data,campaignName){if(null==campaignName)return;const memberships=this.getCampaignMemberships(data);if(null==memberships)return;const role=memberships[campaignName.toLowerCase()];return CampaignRoles.some(roleName=>roleName===role)?role:void 0}getCampaignMemberships(data){if(null==data)return;const campaignMemberships={};for(const campaignIdentifier of Object.keys(data.campaignMemberships)){campaignIdentifier.startsWith(this.ID_IDENTIFIER_PREFIX)||(campaignMemberships[campaignIdentifier.toLowerCase()]=data.campaignMemberships[campaignIdentifier])}return campaignMemberships}static#_2=this.ctorParameters=()=>[{type:module_CBsxN_3E.Qq}]};TokenService=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg._qm)({providedIn:"root"})],TokenService)},"./src/app/auth.store.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>AuthStore});var _angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),_ngrx_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@ngrx/operators/fesm2022/ngrx-operators.mjs"),_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals.mjs"),_ngrx_signals_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals-rxjs-interop.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/pipe.js"),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js"),rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),src_utils_store_withQueries__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/utils/store/withQueries/index.ts"),_models_toast__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/app/_models/toast.ts"),_services_routing_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/app/_services/routing.service.ts"),_services_utils_token_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/app/_services/utils/token.service.ts"),_design_organisms_toast_overlay_toast_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/app/design/organisms/toast-overlay/toast.service.ts");const AuthStore=(0,_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__.Eu)({providedIn:"root"},(0,src_utils_store_withQueries__WEBPACK_IMPORTED_MODULE_4__.j)(()=>{const tokenService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(_services_utils_token_service__WEBPACK_IMPORTED_MODULE_1__.B);return{authData:()=>tokenService.fetchAuthData()}}),(0,_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__.QO)(state=>({isLoggedIn:(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.EW)(()=>{if("init"===state.authDataQueryState()||"loading"===state.authDataQueryState())return;return null!=state.authData()}),isGlobalAdmin:(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.EW)(()=>state.authData()?.isAdmin||state.authData()?.isSuperUser),currentUserName:(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.EW)(()=>state.authData()?.userName),currentUserPk:(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.EW)(()=>state.authData()?.userId)})),(0,_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__.RI)(state=>{const tokenService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(_services_utils_token_service__WEBPACK_IMPORTED_MODULE_1__.B),toastService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(_design_organisms_toast_overlay_toast_service__WEBPACK_IMPORTED_MODULE_2__.f),routingService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(_services_routing_service__WEBPACK_IMPORTED_MODULE_0__.O);return{getCampaignRole:campaignName=>{const userData=state.authData();if(null!=userData)return tokenService.getCampaignRole(userData,campaignName)},login:(0,_ngrx_signals_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.o)((0,rxjs__WEBPACK_IMPORTED_MODULE_8__.F)((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.M)(()=>(0,_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__.M8)(state,{authData:void 0,authDataError:void 0,authDataQueryState:"loading"})),(0,rxjs__WEBPACK_IMPORTED_MODULE_10__.n)(loginData=>tokenService.login(loginData)),(0,_ngrx_operators__WEBPACK_IMPORTED_MODULE_11__.Hn)({next:authData=>(0,_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__.M8)(state,{authData,authDataQueryState:"success"}),error:err=>{(0,_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__.M8)(state,{authDataQueryState:void 0,authDataError:err}),(0,_models_toast__WEBPACK_IMPORTED_MODULE_12__.oP)(err)}}))),logout:(0,_ngrx_signals_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.o)((0,rxjs__WEBPACK_IMPORTED_MODULE_8__.F)((0,rxjs__WEBPACK_IMPORTED_MODULE_10__.n)(()=>tokenService.logout()),(0,_ngrx_operators__WEBPACK_IMPORTED_MODULE_11__.Hn)({next:()=>{(0,_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__.M8)(state,{authData:void 0}),routingService.routeToPath("login")},error:err=>toastService.addToast((0,_models_toast__WEBPACK_IMPORTED_MODULE_12__.oP)(err))}))),patchPassword:(0,_ngrx_signals_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.o)((0,rxjs__WEBPACK_IMPORTED_MODULE_8__.F)((0,rxjs__WEBPACK_IMPORTED_MODULE_10__.n)(({oldPassword,newPassword})=>tokenService.patchMyPassword(newPassword,oldPassword)),(0,_ngrx_operators__WEBPACK_IMPORTED_MODULE_11__.Hn)({next:authData=>(0,_ngrx_signals__WEBPACK_IMPORTED_MODULE_3__.M8)(state,{authData}),error:err=>toastService.addToast((0,_models_toast__WEBPACK_IMPORTED_MODULE_12__.oP)(err))})))}}))},"./src/app/design/molecule/list/list.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  display: block;\n  list-style: none;\n}\n\n:host {\n  outline: none;\n  outline-offset: -4px;\n}\n:host:focus-visible {\n  outline: var(--focus-outline);\n  border-radius: var(--bs-border-radius);\n}\n\n.list__item {\n  outline: none;\n  outline-offset: -3px;\n}\n.list__item:focus-visible, .list__item:has(:focus-visible) {\n  outline: var(--focus-outline);\n  border-radius: var(--bs-border-radius);\n}\n.list__tooltip {\n  max-width: 300px;\n}\n\n.tooltip {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  gap: var(--spacer-2);\n  justify-content: center;\n  align-items: center;\n  opacity: 1;\n}\n.tooltip__entry {\n  padding: var(--spacer-0) var(--spacer-2);\n}\n.tooltip__entry-text {\n  line-break: loose;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/molecules/overview-entry/overview-entry.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  --image-dimension: 80px;\n  display: flex;\n  flex-direction: row;\n  min-height: var(--image-dimension);\n  width: 100%;\n  align-items: center;\n  overflow: hidden;\n}\n\n.img {\n  height: var(--image-dimension);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: fit-content;\n}\n\n.text-content {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  width: 100%;\n  min-height: var(--image-dimension);\n  overflow: hidden;\n  padding-right: var(--spacer-2);\n  padding-left: var(--spacer-2);\n}\n.text-content__header {\n  width: fit-content;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n}\n.text-content__body {\n  text-overflow: ellipsis;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 2;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/molecules/overview-entry/overview-entry.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>OverviewEntryComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var overview_entry_componentngResource=__webpack_require__("./src/app/design/molecules/overview-entry/overview-entry.component.scss?ngResource"),overview_entry_componentngResource_default=__webpack_require__.n(overview_entry_componentngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),DOM=__webpack_require__("./src/utils/DOM.ts");let OverviewEntryComponent=class OverviewEntryComponent{constructor(){this.img=core.input.required(),this.header=core.input.required(),this.body=(0,core.input)(),this.defaultBorder=(0,core.input)(!0),this.headerId=`header-${(0,DOM.n)()}`,this.bodyId=(0,resource_BarKSp_3.EW)(()=>!!this.body()?`body-${(0,DOM.n)()}`:void 0)}static#_=this.propDecorators={img:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"img",required:!0,transform:void 0}]}],header:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"header",required:!0,transform:void 0}]}],body:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"body",required:!1,transform:void 0}]}],defaultBorder:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"defaultBorder",required:!1,transform:void 0}]}]}};OverviewEntryComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"app-overview-entry",imports:[common.kt],template:'<div class="img">\n  \x3c!-- Must be consistent with --image-dimension css property --\x3e\n  <img\n    width="80"\n    height="80"\n    [ngSrc]="img().src"\n    [alt]="img().alt"\n    [placeholder]="img().placeholder ?? false"\n  />\n</div>\n<div class="text-content border-start">\n  <div\n    class="text-content__header fs-5 fw-bold"\n    [class.border-bottom]="!!body()"\n    [id]="headerId"\n  >\n    {{ header() }}\n  </div>\n  <div class="text-content__body">{{ body() }}</div>\n</div>\n',changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,host:{role:"article","aria-labelledby":"headerId","[attr.aria-describedby]":"bodyId()","[class.border]":"defaultBorder()","[class.border-primary-subtle.rounded]":"defaultBorder()","[class.rounded]":"defaultBorder()"},styles:[overview_entry_componentngResource_default()]})],OverviewEntryComponent)},"./src/app/design/molecules/sidebar-button-entry/sidebar-button-entry.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".entry--active,\n.entry :hover,\n.entry :focus-visible {\n  color: var(--entry-hover-color);\n  background-color: var(--entry-hover-bg-color);\n}\n.entry__link {\n  display: flex;\n  align-items: center;\n  padding-left: var(--spacer-3);\n  list-style-type: none;\n  height: 2.75rem;\n  font-weight: bold;\n  font-size: large;\n  width: 100%;\n  outline: none;\n  border-radius: 0;\n}\n.entry__link:focus-visible {\n  outline: var(--focus-outline);\n}\n.entry__link--disabled {\n  color: var(--bs-gray-600);\n  pointer-events: none;\n}\n.entry__icon {\n  width: var(--spacer-5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/molecules/sidebar-link-entry/sidebar-link-entry.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".entry__link {\n  display: flex;\n  align-items: center;\n  padding-left: var(--spacer-3);\n  list-style-type: none;\n  height: 2.75rem;\n  font-weight: bold;\n  font-size: large;\n  width: 100%;\n  outline: none;\n  border-radius: 0;\n  text-decoration: none;\n}\n.entry__link:focus-visible {\n  outline: var(--focus-outline);\n}\n.entry__link--install-button {\n  border: 3px solid var(--bs-primary);\n}\n.entry__link--disabled {\n  color: var(--bs-gray-600);\n  pointer-events: none;\n}\n.entry__icon {\n  width: var(--spacer-5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/organisms/_model/sidebar.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{hs:()=>getMetadataForType,oq:()=>SidebarService});var tslib__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),src_app_services_pwa_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/app/_services/pwa.service.ts"),src_app_services_routing_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/app/_services/routing.service.ts"),src_app_auth_store__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/app/auth.store.ts"),src_app_global_store__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/app/global.store.ts"),src_app_navigation_store__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/app/navigation.store.ts");const ARTICLE_META_ENTRIES=[{title:"Campaign Admin",iconClass:"hammer",route:"campaign-admin",color:"",article_types:[],showInSidebar:!0,availableOffline:!1,associatedRoutes:new Set(["campaign-admin","campaign-update"]),isActiveTab:!1,requiresRole:"admin"},{title:"Creatures",iconClass:"dragon",route:"creature-overview",color:"var(--creature-color)",article_types:["creature"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["creature-create","creature-update","creature","creature-overview"]),isActiveTab:!1,requiresRole:"guest"},{title:"Characters",iconClass:"male",route:"character-overview",color:"var(--character-color)",article_types:["character"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["character-create","character-update","character","character-overview","quote-overview"]),isActiveTab:!1,requiresRole:"guest"},{title:"DiaryEntries",iconClass:"book-open",route:"diaryentry-overview",color:"var(--diaryentry-color)",article_types:["diaryentry"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["diaryentry-create","diaryentry-update","diaryentry","diaryentry-overview","diaryentry-encounter"]),isActiveTab:!1,requiresRole:"guest"},{title:"Items",iconClass:"magic",route:"item-overview",color:"var(--item-color)",article_types:["item"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["item-create","item-update","item","item-overview"]),isActiveTab:!1,requiresRole:"guest"},{title:"Locations",iconClass:"compass",route:"location-overview",color:"var(--location-color)",article_types:["location"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["location-create","location-update","location","location-overview","marker","marker-create","marker-update"]),isActiveTab:!1,requiresRole:"guest"},{title:"Maps",iconClass:"map",route:"default-map",color:"var(--map-color)",article_types:["map"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["map-create","map-update","map","default-map","marker-map-create"]),isActiveTab:!1,requiresRole:"guest"},{title:"Organizations",iconClass:"sitemap",route:"organization-overview",color:"var(--organization-color)",article_types:["organization"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["organization-create","organization-update","organization","organization-overview"]),isActiveTab:!1,requiresRole:"guest"},{title:"Quests",iconClass:"question-circle",route:"quest-overview",color:"var(--quest-color)",article_types:["quest"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["quest-create","quest-update","quest","quest-overview"]),isActiveTab:!1,requiresRole:"guest"},{title:"Recordings",iconClass:"file-audio",route:"sessionaudio-overview",color:"var(--sessionaudio-color)",article_types:["sessionaudio","recording"],showInSidebar:!0,availableOffline:!1,associatedRoutes:new Set(["sessionaudio-create","sessionaudio","sessionaudio-update","sessionaudio-overview"]),isActiveTab:!1,requiresRole:"guest"},{title:"Rules",iconClass:"book",route:"rules",color:"var(--rules-color)",article_types:["rule","rules"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["rule","rules"]),isActiveTab:!1,requiresRole:"guest"},{title:"Spells",iconClass:"hand-sparkles",route:"spells",color:"var(--spell-color)",article_types:["spell","spells"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["spell","spells"]),isActiveTab:!1,requiresRole:"guest"},{title:"Sessions",iconClass:"calendar-alt",route:"sessions",color:"green",article_types:["session","sessions"],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["sessions"]),isActiveTab:!1,requiresRole:"guest"},{title:"Wiki-Overview",iconClass:"diagram-project",route:"graph",color:"white",article_types:[],showInSidebar:!0,availableOffline:!0,associatedRoutes:new Set(["graph"]),isActiveTab:!1,requiresRole:"guest"},{title:"Wiki Configuration",iconClass:"gear",route:"campaign-config-tables",color:"black",article_types:[],showInSidebar:!0,availableOffline:!1,associatedRoutes:new Set(["campaign-config-tables"]),isActiveTab:!1,requiresRole:"guest"},{title:"",iconClass:"comments",color:"var(--encounter-color)",article_types:["encounter"],showInSidebar:!1,availableOffline:!1,isActiveTab:!1,route:"",associatedRoutes:new Set,requiresRole:"guest"}];function getMetadataForType(type){return ARTICLE_META_ENTRIES.find(entry=>entry.article_types.includes(type))}let SidebarService=class SidebarService{constructor(){this.pwaService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(src_app_services_pwa_service__WEBPACK_IMPORTED_MODULE_0__.A),this.routingService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(src_app_services_routing_service__WEBPACK_IMPORTED_MODULE_1__.O),this.globalStore=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(src_app_global_store__WEBPACK_IMPORTED_MODULE_3__.v),this.authStore=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(src_app_auth_store__WEBPACK_IMPORTED_MODULE_2__.a),this.currentRoute=(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WQX)(src_app_navigation_store__WEBPACK_IMPORTED_MODULE_4__.A).currentRoute,this.activeRouteName=(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.EW)(()=>this.currentRoute()?.data?.name),this.canInstallPwa=(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.ot)(this.pwaService.canInstall$),this.profileUrl=this.routingService.getRoutePath("direct-profile"),this.sidebarEntries=(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.EW)(()=>{const campaign=this.globalStore.currentCampaign();if(!campaign)return[];const entries=[{kind:"button",actionName:"search",iconClass:"search",title:"Search",requiresRole:"guest",availableOffline:!1,isActiveTab:!1},...ARTICLE_META_ENTRIES.filter(entry=>entry.showInSidebar).map(entry=>{const route=this.routingService.hasRoutePath(entry.route)?this.routingService.getRoutePath(entry.route,{campaign:campaign.name}):entry.route,activeRouteName=this.activeRouteName(),isActiveTab=!!activeRouteName&&entry.associatedRoutes.has(activeRouteName);return{kind:"link",availableOffline:entry.availableOffline,iconClass:entry.iconClass,route,title:entry.title,requiresRole:entry.requiresRole,associatedRoutes:entry.associatedRoutes,isActiveTab}})],currentRole=this.authStore.isGlobalAdmin()?"admin":this.authStore.getCampaignRole(campaign.name)??"guest";return entries.filter(entry=>(0,src_app_global_store__WEBPACK_IMPORTED_MODULE_3__.a)(currentRole,entry.requiresRole))}),this.sidebarFooterEntries=(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.EW)(()=>{const campaign=this.globalStore.currentCampaign();if(!campaign)return[];const currentRole=this.authStore.isGlobalAdmin()?"admin":this.authStore.getCampaignRole(campaign.name)??"guest",entries=[{kind:"link",title:"Profile",iconClass:"circle-user",route:this.profileUrl,availableOffline:!0,requiresRole:"guest",isActiveTab:"direct-profile"===this.activeRouteName(),associatedRoutes:new Set},{kind:"button",actionName:"logout",iconClass:"right-from-bracket",title:"Logout",requiresRole:"guest",availableOffline:!0,isActiveTab:!1}];return this.canInstallPwa()&&entries.unshift({kind:"button",actionName:"pwaInstall",iconClass:"file-arrow-down",title:"Install App",requiresRole:"guest",availableOffline:!1,isActiveTab:!1,extraClass:"sidebar__entry--install-button"}),entries.filter(entry=>(0,src_app_global_store__WEBPACK_IMPORTED_MODULE_3__.a)(currentRole,entry.requiresRole))})}};SidebarService=(0,tslib__WEBPACK_IMPORTED_MODULE_8__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_9__._qm)({providedIn:"root"})],SidebarService)},"./src/app/design/organisms/sidebar/sidebar.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"a {\n  text-decoration: none;\n}\n\n:host {\n  --entry-hover-color: var(--bs-link-hover-color);\n  --entry-hover-bg-color: var(--bs-gray-700);\n  --brand-height: 3rem;\n  background-color: var(--bs-gray-dark);\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100mvh;\n  height: 100%;\n}\n\n.offcanvas-body,\n.offcanvas-header {\n  --bs-offcanvas-padding-y: 0;\n  --bs-offcanvas-padding-x: 0;\n}\n\n.offcanvas-body {\n  display: flex;\n  flex-direction: column;\n}\n\n.sidebar__brand {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n}\n.sidebar__entries {\n  list-style-type: none;\n  margin: var(--spacer-1) 0 0 0;\n  padding: 0;\n  flex: 1;\n}\n.sidebar__entry--active, .sidebar__entry:hover, .sidebar__entry:focus-visible {\n  color: var(--entry-hover-color);\n  background-color: var(--entry-hover-bg-color);\n}\n.sidebar__entry--install-button {\n  border: 3px solid var(--bs-primary);\n}\n.sidebar__footer {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n  border-top: 4px inset;\n}\n\n.brand {\n  display: flex;\n  height: var(--brand-height);\n  font-size: 1.5rem;\n  flex: 1;\n}\n.brand__back :focus-visible {\n  outline: var(--focus-outline);\n  border-bottom-right-radius: var(--bs-border-radius);\n}\n.brand__back :hover,\n.brand__back :focus-visible {\n  color: var(--entry-hover-color);\n  background-color: var(--entry-hover-bg-color);\n  height: var(--brand-height);\n}\n.brand__back-link {\n  font-size: 32px;\n  height: 100%;\n  font-weight: bold;\n  display: flex;\n  padding-right: var(--spacer-3);\n  padding-left: var(--spacer-3);\n  border-right: solid 2px var(--bs-white);\n  outline: none;\n  border-radius: 0;\n}\n.brand__back-link:focus-visible {\n  outline: var(--focus-outline);\n}\n.brand__back-icon {\n  display: flex;\n  align-items: center;\n}\n.brand__home {\n  height: var(--brand-height);\n  flex: 1;\n}\n.brand__home :focus-visible {\n  outline: var(--focus-outline);\n}\n.brand__home :hover,\n.brand__home :focus-visible {\n  color: var(--entry-hover-color) !important;\n  background-color: var(--entry-hover-bg-color);\n  border-bottom-left-radius: var(--bs-border-radius);\n}\n.brand__home-link {\n  padding-left: var(--spacer-2);\n  color: inherit;\n  font-size: 24px;\n  display: flex;\n  align-items: center;\n  height: 100%;\n  outline: none;\n  border-radius: 0;\n}\n.brand__home-link:focus-visible {\n  outline: var(--focus-outline);\n}\n.brand__home-link--active {\n  background-color: var(--entry-hover-bg-color);\n}\n.brand__home-link-text {\n  display: flex;\n  width: 100%;\n  align-items: center;\n  justify-content: flex-start;\n  color: inherit;\n  margin: var(--spacer-0);\n}\n.brand__home-link-text-text {\n  margin-left: var(--spacer-2);\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.brand__icon {\n  height: 32px;\n  width: 32px;\n  border-radius: var(--bs-border-radius);\n}\n\n.footer {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: var(--spacer-3);\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/organisms/sidebar/sidebar.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{k:()=>SidebarComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var sidebar_componentngResource=__webpack_require__("./src/app/design/organisms/sidebar/sidebar.component.scss?ngResource"),sidebar_componentngResource_default=__webpack_require__.n(sidebar_componentngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),common_module_D4mHDfs1=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-D4mHDfs1.mjs"),root_effect_scheduler_DCy1y1b8=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),router_module_DTmwsUYo=__webpack_require__("./node_modules/@angular/router/fesm2022/router_module-DTmwsUYo.mjs"),ng_bootstrap=__webpack_require__("./node_modules/@ng-bootstrap/ng-bootstrap/fesm2022/ng-bootstrap.mjs"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),online_service=__webpack_require__("./src/app/_services/online.service.ts"),pwa_service=__webpack_require__("./src/app/_services/pwa.service.ts"),routing_service=__webpack_require__("./src/app/_services/routing.service.ts"),swipe_service=__webpack_require__("./src/app/_services/swipe.service.ts"),app_constants=__webpack_require__("./src/app/app.constants.ts"),auth_store=__webpack_require__("./src/app/auth.store.ts"),icon_component=__webpack_require__("./src/app/design/atoms/icon/icon.component.ts"),search_modal_component=__webpack_require__("./src/app/global-components/search/search-modal/search-modal.component.ts"),navigation_store=__webpack_require__("./src/app/navigation.store.ts"),DOM=__webpack_require__("./src/utils/DOM.ts");var sidebar_button_entry_componentngResource=__webpack_require__("./src/app/design/molecules/sidebar-button-entry/sidebar-button-entry.component.scss?ngResource"),sidebar_button_entry_componentngResource_default=__webpack_require__.n(sidebar_button_entry_componentngResource);let SidebarButtonEntryComponent=class SidebarButtonEntryComponent{constructor(){this.icon=(0,core.input)(),this.label=core.input.required(),this.entryClicked=(0,core.output)()}static#_=this.propDecorators={icon:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"icon",required:!1,transform:void 0}]}],label:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"label",required:!0,transform:void 0}]}],entryClicked:[{type:debug_node_JnOYh9kg.k7i,args:["entryClicked"]}]}};SidebarButtonEntryComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"li[sidebar-button-entry]",imports:[icon_component.R],template:'<button class="entry__link" (click)="entryClicked.emit($event)">\n  @let ico = icon();\n  @if (ico) {\n    <app-icon class="entry__icon" [icon]="ico"></app-icon>\n  }\n  <span class="entry__text">\n    {{ label() }}\n  </span>\n</button>\n',changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,host:{class:"entry"},styles:[sidebar_button_entry_componentngResource_default()]})],SidebarButtonEntryComponent);var sidebar_link_entry_componentngResource=__webpack_require__("./src/app/design/molecules/sidebar-link-entry/sidebar-link-entry.component.scss?ngResource"),sidebar_link_entry_componentngResource_default=__webpack_require__.n(sidebar_link_entry_componentngResource);let SidebarLinkEntryComponent=class SidebarLinkEntryComponent{constructor(){this.online$=(0,root_effect_scheduler_DCy1y1b8.WQX)(online_service.D).online$,this.online=(0,rxjs_interop.ot)(this.online$),this.isOffline=(0,resource_BarKSp_3.EW)(()=>!1===this.online()),this.entry=core.input.required()}static#_=this.propDecorators={entry:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"entry",required:!0,transform:void 0}]}]}};SidebarLinkEntryComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"li[sidebar-link-entry]",imports:[icon_component.R,common_module_D4mHDfs1.Jj,router_module_DTmwsUYo.Wk],template:'@let isEntryDisabled = (online$ | async) === false && !entry().availableOffline;\n<a\n  [routerLink]="isEntryDisabled ? \'\' : entry().route"\n  class="entry__link"\n  [ariaDisabled]="isEntryDisabled"\n  [class.entry__link--disabled]="isEntryDisabled"\n>\n  <app-icon class="entry__icon" [icon]="entry().iconClass"></app-icon>\n  {{ entry().title }}\n  @if (isEntryDisabled) {\n    <app-icon class="entry__icon" [icon]="\'ban\'"></app-icon>\n  }\n</a>\n',changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,host:{class:"entry","[class.entry--active]":"entry().isActiveTab"},styles:[sidebar_link_entry_componentngResource_default()]})],SidebarLinkEntryComponent);var sidebar=__webpack_require__("./src/app/design/organisms/_model/sidebar.ts");let SidebarComponent=class SidebarComponent{constructor(){this.sidebarService=(0,root_effect_scheduler_DCy1y1b8.WQX)(sidebar.oq),this.pwaService=(0,root_effect_scheduler_DCy1y1b8.WQX)(pwa_service.A),this.authStore=(0,root_effect_scheduler_DCy1y1b8.WQX)(auth_store.a),this.modalService=(0,root_effect_scheduler_DCy1y1b8.WQX)(ng_bootstrap.Bq),this.routingService=(0,root_effect_scheduler_DCy1y1b8.WQX)(routing_service.O),this.swipeService=(0,root_effect_scheduler_DCy1y1b8.WQX)(swipe_service.I),this.host=(0,root_effect_scheduler_DCy1y1b8.WQX)(debug_node_JnOYh9kg.aKT),this.activeOffcanvas=(0,root_effect_scheduler_DCy1y1b8.WQX)(ng_bootstrap.DI),this.online$=(0,root_effect_scheduler_DCy1y1b8.WQX)(online_service.D).online$,this.sidebarSwipesLeft$=this.swipeService.getSwipeEvents(this.host).pipe((0,filter.p)(swipeDistance=>swipeDistance<-1*app_constants.Mw)),this.currentRoute=(0,root_effect_scheduler_DCy1y1b8.WQX)(navigation_store.A).currentRoute,this.campaign=(0,core.input)(void 0),this.hasCampaignAdminPrivileges=(0,core.input)(!1),this.activeRouteName=(0,resource_BarKSp_3.EW)(()=>this.currentRoute()?.data?.name),this.logout=(0,core.output)(),this.closeSidebar=(0,core.output)(),this.serverUrl="",this.canInstallPwa=(0,rxjs_interop.ot)(this.pwaService.canInstall$),this.sidebarEntries=this.sidebarService.sidebarEntries,this.sidebarFooterEntries=this.sidebarService.sidebarFooterEntries,this.headerId=`${(0,DOM.n)()}-header`,this.campaignOverviewUrl=this.routingService.getRoutePath("campaign-overview"),this.campaignAdminUrl=(0,resource_BarKSp_3.EW)(()=>this.routingService.getRoutePath("campaign-admin",{campaign:this.campaign()?.name})),this.homeUrl=(0,resource_BarKSp_3.EW)(()=>this.routingService.getRoutePath("home",{campaign:this.campaign()?.name})),this.profileUrl=this.routingService.getRoutePath("direct-profile"),this.sidebarSwipesLeft$.pipe((0,rxjs_interop.pQ)()).subscribe(()=>this.closeSidebar.emit())}onSidebarButtonClicked(actionName){switch(actionName){case"logout":this.logout.emit();break;case"pwaInstall":this.pwaService.showInstallPrompt();break;case"search":this.openSearchModal()}}openSearchModal(){const ref=this.modalService.open(search_modal_component.R),titleId=ref.componentInstance.titleId;ref.update({ariaLabelledBy:titleId})}static#_=this.ctorParameters=()=>[];static#_2=this.propDecorators={campaign:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"campaign",required:!1,transform:void 0}]}],hasCampaignAdminPrivileges:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"hasCampaignAdminPrivileges",required:!1,transform:void 0}]}],logout:[{type:debug_node_JnOYh9kg.k7i,args:["logout"]}],closeSidebar:[{type:debug_node_JnOYh9kg.k7i,args:["closeSidebar"]}]}};SidebarComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"app-sidebar",template:'@let isOffline = (online$ | async) === false;\n@let offlineTooltip = "Not available offline";\n@if (campaign()) {\n  <div class="offcanvas-header">\n    <div class="sidebar__brand brand">\n      <div class="brand__back">\n        <a\n          [routerLink]="campaignOverviewUrl"\n          class="brand__back-link"\n          aria-label="\'To campaign overview\'"\n        >\n          <app-icon class="brand__back-icon" [icon]="\'chevron-left\'"></app-icon>\n        </a>\n      </div>\n\n      <div class="brand__home" [class.disabled-entry]="campaign() == null">\n        <a\n          class="brand__home-link"\n          [routerLink]="homeUrl()"\n          [routerLinkActive]="\'brand__home-link--active\'"\n        >\n          <div class="h4 brand__home-link-text" [id]="headerId">\n            <img\n              class="brand__icon"\n              [ngSrc]="serverUrl + campaign()?.icon"\n              alt=""\n              priority\n              [width]="32"\n              [height]="32"\n            />\n            <div class="brand__home-link-text-text">\n              {{ campaign()?.name }}\n            </div>\n          </div>\n        </a>\n      </div>\n    </div>\n  </div>\n  <div class="offcanvas-body">\n    <ul class="sidebar__entries">\n      \x3c!-- Campaign Overview Entries --\x3e\n      @for (entry of sidebarEntries(); track entry.title) {\n        @let isDisabledEntry = isOffline && !entry.availableOffline;\n        @switch (entry.kind) {\n          @case ("link") {\n            <li\n              [class]="[\'sidebar__entry\', entry.extraClass ?? \'\']"\n              [class.sidebar__entry--active]="entry.isActiveTab"\n              sidebar-link-entry\n              [entry]="entry"\n              [ngbTooltip]="isDisabledEntry ? offlineTooltip : undefined"\n            ></li>\n          }\n          @case ("button") {\n            <li\n              [class]="[\'sidebar__entry\', entry.extraClass ?? \'\']"\n              sidebar-button-entry\n              [icon]="entry.iconClass"\n              [label]="entry.title"\n              (entryClicked)="onSidebarButtonClicked(entry.actionName)"\n            ></li>\n          }\n        }\n      }\n    </ul>\n\n    <ul class="sidebar__footer footer">\n      @for (entry of sidebarFooterEntries(); track entry.title) {\n        @let isDisabledEntry = isOffline && !entry.availableOffline;\n        @switch (entry.kind) {\n          @case ("link") {\n            <li\n              [class]="[\'sidebar__entry\', entry.extraClass ?? \'\']"\n              [class.sidebar__entry--active]="entry.isActiveTab"\n              sidebar-link-entry\n              [entry]="entry"\n              [ngbTooltip]="isDisabledEntry ? offlineTooltip : undefined"\n            ></li>\n          }\n          @case ("button") {\n            <li\n              [class]="[\'sidebar__entry\', entry.extraClass ?? \'\']"\n              sidebar-button-entry\n              [icon]="entry.iconClass"\n              [label]="entry.title"\n              (entryClicked)="onSidebarButtonClicked(entry.actionName)"\n            ></li>\n          }\n        }\n      }\n    </ul>\n  </div>\n}\n\n<ng-template #nonCampaignBrand>\n  <ul class="brand-line d-flex">\n    <li class="flex-1">\n      <a class="ps-0" [routerLink]="campaignOverviewUrl">\n        <h3 class="d-flex align-items-center justify-content-center" id="brand">\n          <span class="fas fa-chevron-left"></span>\n          <span class="ms-2 on-hover-show"> To campaigns</span>\n        </h3>\n      </a>\n    </li>\n  </ul>\n</ng-template>\n',imports:[router_module_DTmwsUYo.Wk,common.kt,icon_component.R,common_module_D4mHDfs1.Jj,ng_bootstrap.n8,SidebarButtonEntryComponent,router_module_DTmwsUYo.wQ,SidebarLinkEntryComponent],providers:[ng_bootstrap.DI],changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,host:{role:"navigation","[attr.aria-labelledby]":"headerId"},styles:[sidebar_componentngResource_default()]})],SidebarComponent)},"./src/app/global-components/search/search-modal/search-modal.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  display: block;\n}\n\n@media (min-width: 768px) {\n  ::ng-deep .search-modal {\n    max-width: 1000px !important;\n  }\n}\n\n.body {\n  display: flex;\n  flex-direction: column;\n  height: 572px;\n}\n.body__search-field-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-bottom: var(--spacer-4);\n  gap: var(--bs-modal-padding);\n}\n.body__search-field {\n  margin: 0;\n  width: 100%;\n}\n.body__search-results {\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacer-2);\n  overflow-y: scroll;\n  height: 100%;\n}\n.body__search-results--hidden {\n  display: none;\n}\n.body__search-result-link {\n  font-weight: unset;\n  text-decoration: unset;\n  outline: none;\n  border: var(--bs-border-width) var(--bs-border-style) var(--bs-border-color);\n  border-radius: var(--bs-border-radius);\n  display: flex;\n  align-items: center;\n}\n.body__search-result-link:hover, .body__search-result-link:focus, .body__search-result-link--in-focus {\n  background-color: var(--bs-black);\n  color: var(--bs-link-hover-color);\n}\n.body__search-result {\n  background-color: inherit;\n  border-left-width: 8px !important;\n  border-left-style: solid;\n  border-radius: var(--bs-border-radius);\n}\n.body__search-result-icon {\n  font-size: 30px;\n  opacity: 0.5;\n  margin-right: var(--spacer-2);\n}\n.body__spinner-container {\n  width: 36px;\n  height: 36px;\n}\n\n.empty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.empty__icon {\n  font-size: 200px;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/global-components/search/search-modal/search-modal.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{R:()=>SearchModalComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var search_modal_componentngResource=__webpack_require__("./src/app/global-components/search/search-modal/search-modal.component.scss?ngResource"),search_modal_componentngResource_default=__webpack_require__.n(search_modal_componentngResource),a11y_module_BPzgKr79=__webpack_require__("./node_modules/@angular/cdk/fesm2022/a11y-module-BPzgKr79.mjs"),root_effect_scheduler_DCy1y1b8=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),router_CsukTOog=__webpack_require__("./node_modules/@angular/router/fesm2022/router-CsukTOog.mjs"),router_module_DTmwsUYo=__webpack_require__("./node_modules/@angular/router/fesm2022/router_module-DTmwsUYo.mjs"),ng_bootstrap=__webpack_require__("./node_modules/@ng-bootstrap/ng-bootstrap/fesm2022/ng-bootstrap.mjs"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),withLatestFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/withLatestFrom.js"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),hotkey_directive=__webpack_require__("./src/app/_directives/hotkey.directive.ts"),hotkey_service=__webpack_require__("./src/app/_services/hotkey.service.ts"),online_service=__webpack_require__("./src/app/_services/online.service.ts"),button_component=__webpack_require__("./src/app/design/atoms/button/button.component.ts"),icon_component=__webpack_require__("./src/app/design/atoms/icon/icon.component.ts"),spinner_component=__webpack_require__("./src/app/design/atoms/spinner/spinner.component.ts");var list_componentngResource=__webpack_require__("./src/app/design/molecule/list/list.component.scss?ngResource"),list_componentngResource_default=__webpack_require__.n(list_componentngResource),common_module_D4mHDfs1=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-D4mHDfs1.mjs"),combineLatest=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js"),switchMap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),merge=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/merge.js"),fromEvent=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js"),startWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),tap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js"),debounceTime=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js"),keyMapper=__webpack_require__("./src/app/_functions/keyMapper.ts");let ListComponent=class ListComponent{constructor(){this.shortcutService=(0,root_effect_scheduler_DCy1y1b8.WQX)(hotkey_service.Q),this.tooltip=(0,root_effect_scheduler_DCy1y1b8.WQX)(ng_bootstrap.md),this.host=(0,root_effect_scheduler_DCy1y1b8.WQX)(debug_node_JnOYh9kg.aKT),this.entries=core.input.required(),this.arrowKeyNavigationOptions=(0,core.input)(),this.listItemClasses=(0,core.input)(""),this.entryActivated=(0,core.output)(),this.entryTemplate=core.contentChild.required("entryTemplate"),this.entryElements=(0,core.viewChildren)("listItem"),this.tooltipContent=core.viewChild.required("tipContent"),this.shortcutActionKeys=(0,rxjs_interop.ot)((0,combineLatest.z)({nextEntryKeys:this.shortcutService.getKeySequence("jump-to-next-entry"),priorEntryKeys:this.shortcutService.getKeySequence("jump-to-prior-entry")})),this.listItemClassStr=(0,resource_BarKSp_3.EW)(()=>{const classes=this.listItemClasses();return(Array.isArray(classes)?classes:[classes]).join(" ")}),this.focusIndex$=(0,rxjs_interop.br)(this.entryElements).pipe((0,switchMap.n)(entries=>(0,merge.h)(...entries.map((entry,index)=>(0,fromEvent.R)(entry.nativeElement,"focusin").pipe((0,map.T)(()=>index))))),(0,startWith.Z)(void 0)),this.lastElementIndex=(0,resource_BarKSp_3.EW)(()=>this.entries().length-1),this.lastElementIndex$=(0,rxjs_interop.br)(this.lastElementIndex),this.shortcutText=(0,resource_BarKSp_3.EW)(()=>{const keys=this.shortcutActionKeys();if(!keys)return;return`${(0,keyMapper.d)(keys.nextEntryKeys).replaceAll(" ","")} ${(0,keyMapper.d)(keys.priorEntryKeys).replaceAll(" ","")}`}),this.tooltipLines=(0,resource_BarKSp_3.EW)(()=>{const keys=this.shortcutActionKeys();if(!keys)return;return[{text:keys.nextEntryKeys.map(key=>(0,keyMapper.g)(key).replaceAll("+"," + ")).join(" + "),icon:"arrow-down"},{text:keys.priorEntryKeys.map(key=>(0,keyMapper.g)(key).replaceAll("+"," + ")).join(" + "),icon:"arrow-up"}]}),this.setupTooltip(),this.setupKeyboardNavigation()}setupKeyboardNavigation(){const options$=(0,rxjs_interop.br)(this.arrowKeyNavigationOptions).pipe((0,map.T)(opt=>({...opt,eventSource:this.host.nativeElement,keyEventType:"keydown"}))),toNextEntryAction$=options$.pipe((0,switchMap.n)(options=>this.shortcutService.watchAction("jump-to-next-entry",options))),arrowDown$=options$.pipe((0,switchMap.n)(options=>this.shortcutService.watchKey("ArrowDown",options)),(0,tap.M)(event=>{event.preventDefault(),event.stopPropagation()})),toNextEntry$=(0,merge.h)(toNextEntryAction$,arrowDown$).pipe((0,map.T)(()=>"jump-to-next-entry")),toPriorEntryAction$=options$.pipe((0,switchMap.n)(options=>this.shortcutService.watchAction("jump-to-prior-entry",options))),arrowUp$=options$.pipe((0,switchMap.n)(options=>this.shortcutService.watchKey("ArrowUp",options)),(0,tap.M)(event=>{event.preventDefault(),event.stopPropagation()})),toPriorEntry$=(0,merge.h)(toPriorEntryAction$,arrowUp$).pipe((0,map.T)(()=>"jump-to-prior-entry"));(0,merge.h)(toNextEntry$,toPriorEntry$).pipe((0,withLatestFrom.E)(this.focusIndex$,this.lastElementIndex$),(0,map.T)(([shortcutAction,focusIndex,lastElementIndex])=>this.toNextFocusIndex(shortcutAction,focusIndex,lastElementIndex)),(0,map.T)(nextElementIndex=>this.entryElements()?.[nextElementIndex]?.nativeElement),(0,rxjs_interop.pQ)()).subscribe(nextElementToFocus=>nextElementToFocus?.focus())}toNextFocusIndex(shortcutAction,focusIndex,lastElementIndex){switch(shortcutAction){case"jump-to-next-entry":switch(focusIndex){case lastElementIndex:return lastElementIndex;case void 0:return 0;default:return focusIndex+1}case"jump-to-prior-entry":switch(focusIndex){case 0:return 0;case void 0:return lastElementIndex;default:return focusIndex-1}}}setupTooltip(){this.tooltip.triggers="manual",(0,resource_BarKSp_3.QZ)(()=>{const content=this.tooltipContent();content&&(this.tooltip.ngbTooltip=content)});(0,merge.h)((0,fromEvent.R)(this.host.nativeElement,"focus").pipe((0,map.T)(()=>!0)),(0,fromEvent.R)(this.host.nativeElement,"blur").pipe((0,map.T)(()=>!1)),(0,fromEvent.R)(this.host.nativeElement,"mouseover").pipe((0,map.T)(()=>!0)),(0,fromEvent.R)(this.host.nativeElement,"mouseout").pipe((0,map.T)(()=>!1))).pipe((0,debounceTime.B)(50)).pipe((0,rxjs_interop.pQ)()).subscribe(isInFocus=>{isInFocus?this.tooltip.open():this.tooltip.close()})}static#_=this.ctorParameters=()=>[];static#_2=this.propDecorators={entries:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"entries",required:!0,transform:void 0}]}],arrowKeyNavigationOptions:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"arrowKeyNavigationOptions",required:!1,transform:void 0}]}],listItemClasses:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"listItemClasses",required:!1,transform:void 0}]}],entryActivated:[{type:debug_node_JnOYh9kg.k7i,args:["entryActivated"]}],entryTemplate:[{type:core.ContentChild,args:["entryTemplate",{isSignal:!0}]}],entryElements:[{type:core.ViewChildren,args:["listItem",{isSignal:!0}]}],tooltipContent:[{type:core.ViewChild,args:["tipContent",{isSignal:!0}]}]}};ListComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"app-list",imports:[common_module_D4mHDfs1.T3,common_module_D4mHDfs1.Jj,ng_bootstrap.n8,icon_component.R],template:'@let focusIndex = focusIndex$ | async;\n@for (entry of entries(); track entry.trackId) {\n  @let isInFocusForTab = (focusIndex ?? 0) === $index;\n  @let isInFocusVisibly = focusIndex === $index;\n  @let entryLabelId = entry.trackId + "-label";\n  <li\n    [class]="\'list__item \' + listItemClassStr()"\n    [tabindex]="isInFocusForTab ? 0 : -1"\n    #listItem\n    [attr.aria-labelledb]="entryLabelId"\n    (click)="entryActivated.emit(entry.data)"\n    (keydown.Enter)="entryActivated.emit(entry.data)"\n  >\n    <ng-container\n      *ngTemplateOutlet="\n        entryTemplate();\n        context: {\n          $implicit: {\n            data: entry.data,\n            isInFocus: isInFocusVisibly,\n            entryLabelId: entryLabelId,\n            index: $index,\n            first: $first,\n            last: $last,\n          },\n        }\n      "\n    />\n  </li>\n}\n\n<ng-template #tipContent>\n  <div class="list__tooltip tooltip">\n    @for (line of tooltipLines(); track line.icon) {\n      <div class="tooltip__entry">\n        <span class="tooltip__entry-text"> {{ line.text }} = </span>\n        <app-icon [icon]="line.icon" />\n      </div>\n    }\n  </div>\n</ng-template>\n',changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,hostDirectives:[ng_bootstrap.md],host:{tabindex:"-1",role:"list","aria-keyshortcuts":"A"},styles:[list_componentngResource_default()]})],ListComponent);let ListItemContextTypecastDirective=class ListItemContextTypecastDirective{constructor(){this.inferContextTypeFrom=core.input.required()}static ngTemplateContextGuard(directive,ctx){return!0}static#_=this.propDecorators={inferContextTypeFrom:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"inferContextTypeFrom",required:!0,transform:void 0}]}]}};ListItemContextTypecastDirective=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.WLR)({selector:"[inferContextTypeFrom]"})],ListItemContextTypecastDirective);var overview_entry_component=__webpack_require__("./src/app/design/molecules/overview-entry/overview-entry.component.ts"),sidebar=__webpack_require__("./src/app/design/organisms/_model/sidebar.ts"),ngrx_signals=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals.mjs"),shareReplay=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js"),take=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/take.js"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),article_service=__webpack_require__("./src/app/_services/article/article.service.ts"),global_store=__webpack_require__("./src/app/global.store.ts"),rxjs_operators=__webpack_require__("./src/utils/rxjs-operators.ts"),withQueries=__webpack_require__("./src/utils/store/withQueries/index.ts");const SearchPageStore=(0,ngrx_signals.Eu)({providedIn:"root"},(0,ngrx_signals.Q2)({}),(0,withQueries.j)(()=>{const articleService=(0,root_effect_scheduler_DCy1y1b8.WQX)(article_service.q),globalStore=(0,root_effect_scheduler_DCy1y1b8.WQX)(global_store.v),campaignName$=(0,rxjs_interop.br)(globalStore.campaignName).pipe((0,rxjs_operators.u5)(),(0,shareReplay.t)(1));return{searchArticles:searchString=>campaignName$.pipe((0,take.s)(1),(0,switchMap.n)(campaignName=>searchString?articleService.getCampaignSearchArticle(campaignName,searchString):(0,of.of)({emptyResponse:"",articles:[]})))}}),(0,ngrx_signals.RI)(store=>({reset:()=>(0,ngrx_signals.M8)(store,{searchArticlesError:void 0,searchArticlesQueryState:"init",searchArticles:void 0})})));var SearchModalComponent_1,DOM=__webpack_require__("./src/utils/DOM.ts"),string=__webpack_require__("./src/utils/string.ts"),search_field_component=__webpack_require__("./src/app/design/molecules/search-field/search-field.component.ts");let SearchModalComponent=class SearchModalComponent{static#_=SearchModalComponent_1=this;constructor(){this.modalService=(0,root_effect_scheduler_DCy1y1b8.WQX)(ng_bootstrap.Bq),this.hotkeyService=(0,root_effect_scheduler_DCy1y1b8.WQX)(hotkey_service.Q),this.globalStore=(0,root_effect_scheduler_DCy1y1b8.WQX)(global_store.v),this.onlineService=(0,root_effect_scheduler_DCy1y1b8.WQX)(online_service.D),this.searchStore=(0,root_effect_scheduler_DCy1y1b8.WQX)(SearchPageStore),this.router=(0,root_effect_scheduler_DCy1y1b8.WQX)(router_CsukTOog.Ix),this.announcer=(0,root_effect_scheduler_DCy1y1b8.WQX)(a11y_module_BPzgKr79.L),this.listElement=core.viewChild.required("list",{read:debug_node_JnOYh9kg.aKT}),this.id=(0,DOM.n)(),this.titleId=`${this.id}-title`,this.listId=`${this.id}-list`,this.DEFAULT_URL="assets/default_images/icon_default.webp",this.campaignName=this.globalStore.campaignName,this.isLoading=(0,resource_BarKSp_3.EW)(()=>"loading"===this.searchStore.searchArticlesQueryState()),this.isEmptySearch=(0,resource_BarKSp_3.EW)(()=>{const hasEntries=(this.searchStore.searchArticles()?.articles?.length??0)>0;return"success"===this.searchStore.searchArticlesQueryState()&&!hasEntries}),this.entries=(0,resource_BarKSp_3.EW)(()=>{const articles=this.searchStore.searchArticles()?.articles;return articles?.map(article=>{const metadata=(0,sidebar.hs)(article.article_type);return{data:{name:article.name,description:article.description,url:article.getAbsoluteRouterUrl(),color:metadata?.color,icon:metadata?.iconClass,article_type:(0,string.ZH)(article.article_type)},trackId:article.pk??(0,DOM.n)(),ariaText:{kind:"aria-labelledby",id:`overview-entry-${article.article_type}-${article.pk}`}}})}),this.announcer.announce("test");const hasCurrentCampaign$=(0,rxjs_interop.br)(this.globalStore.currentCampaign).pipe((0,map.T)(campaign=>!!campaign));this.hotkeyService.watchAction("search").pipe((0,withLatestFrom.E)(hasCurrentCampaign$,this.onlineService.online$),(0,filter.p)(([,hasCurrentCampaign,isOnline])=>hasCurrentCampaign&&isOnline),(0,rxjs_interop.pQ)()).subscribe(()=>this.openModal())}routeToEntry(data){this.router.navigateByUrl(data.url),this.modalService.dismissAll()}typecastContext(context){return context}openModal(){this.modalService.hasOpenModals()||this.modalService.open(SearchModalComponent_1,{centered:!0,ariaLabelledBy:this.titleId,modalDialogClass:"search-modal",beforeDismiss:()=>(this.searchStore.reset(),!0)})}dismiss(){this.modalService.dismissAll()}shiftToSearch(){this.listElement().nativeElement.focus()}static#_2=this.ctorParameters=()=>[];static#_3=this.propDecorators={listElement:[{type:core.ViewChild,args:["list",{read:debug_node_JnOYh9kg.aKT,isSignal:!0}]}]}};SearchModalComponent=SearchModalComponent_1=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"app-search-modal",imports:[button_component.Q,hotkey_directive.G,search_field_component.q,spinner_component.t,overview_entry_component.n,ListComponent,router_module_DTmwsUYo.Wk,icon_component.R,ng_bootstrap.md],template:'<div class="modal-border">\n  <div class="modal-header justify-content-between">\n    <div class="h4 modal-title" [id]="titleId">Search</div>\n    <button\n      btn\n      class="rounded"\n      [kind]="\'NONE\'"\n      [icon]="\'xmark\'"\n      aria-label="Close"\n      [hotkeyAction]="\'cancel\'"\n      [watchOptions]="{ isModalAction: true }"\n      (actionTriggered)="dismiss()"\n      (clicked)="dismiss()"\n    ></button>\n  </div>\n\n  <div class="modal-body body">\n    <div class="body__search-field-container">\n      <app-search-field\n        [autofocus]="true"\n        class="body__search-field"\n        [placeholder]="\'Search Query\'"\n        [btnAriaLabel]="\'Start search!\'"\n        [canSearch]="!isLoading()"\n        [ariaControls]="listId"\n        (appSearch)="searchStore.loadSearchArticles($event)"\n        (searchSubmit)="shiftToSearch()"\n      />\n      @if (isLoading()) {\n        <div class="body__spinner-container">\n          <app-spinner />\n        </div>\n      }\n    </div>\n    @let hasEntries = (entries()?.length ?? 0) > 0;\n    <app-list\n      #list\n      [id]="listId"\n      class="body__search-results"\n      [class.body__search-results--hidden]="!hasEntries"\n      [entries]="entries() ?? []"\n      aria-label="Search Results"\n      [arrowKeyNavigationOptions]="{\n        isModalAction: true,\n      }"\n      [attr.aria-busy]="isLoading()"\n      (entryActivated)="routeToEntry($event)"\n    >\n      <ng-template #entryTemplate let-templateContext>\n        @let context = typecastContext(templateContext);\n        <a\n          class="body__search-result-link"\n          [class.body__search-result-link--in-focus]="context.isInFocus"\n          [routerLink]="context.data.url"\n          [tabIndex]="context.isInFocus ? 0 : -1"\n          [ngbTooltip]="context.data.name"\n          [id]="context.entryLabelId"\n        >\n          @let color = context.data.color + " !important";\n          <app-overview-entry\n            class="body__search-result"\n            [style]="{\n              \'border-left-color\': color,\n            }"\n            [header]="context.data.name"\n            [defaultBorder]="false"\n            [body]="context.data.description"\n            [img]="{\n              src: context.data.images?.[0] ?? DEFAULT_URL,\n              alt: \'\',\n              placeholder: DEFAULT_URL,\n            }"\n          />\n          <app-icon\n            class="body__search-result-icon"\n            [icon]="context.data.icon"\n            [ngbTooltip]="context.data.article_type"\n          />\n        </a>\n      </ng-template>\n    </app-list>\n    @if (isEmptySearch()) {\n      <div class="body__empty empty">\n        <app-icon class="empty__icon" [icon]="\'search\'" />\n        <div class="empty__text">\n          {{ searchStore.searchArticles()?.emptyResponse }} <br />\n          <div class="h4">We couldn\'t find any hits</div>\n        </div>\n      </div>\n    }\n\n    <div class="cdk-visually-hidden" aria-live="polite">\n      @if (searchStore.searchArticlesQueryState() === "success") {\n        {{ searchStore.searchArticles()?.articles?.length }} results found\n      }\n    </div>\n  </div>\n</div>\n',changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,styles:[search_modal_componentngResource_default()]})],SearchModalComponent)},"./src/app/global.store.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{v:()=>GlobalStore,a:()=>hasRoleOrBetter});var root_effect_scheduler_DCy1y1b8=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),ngrx_operators=__webpack_require__("./node_modules/@ngrx/operators/fesm2022/ngrx-operators.mjs"),ngrx_signals=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals.mjs"),ngrx_signals_rxjs_interop=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals-rxjs-interop.mjs"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),Observable=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Observable.js"),take=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/take.js"),pipe=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/pipe.js"),logging=__webpack_require__("./src/utils/logging.ts"),online_service=__webpack_require__("./src/app/_services/online.service.ts"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),module_CBsxN_3E=__webpack_require__("./node_modules/@angular/common/fesm2022/module-CBsxN_3E.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),shareReplay=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js");function convertSingleFileModelToFormData(model,fileAttributeName="file"){if(!model.hasOwnProperty(fileAttributeName))throw new Error(`Can't convert object to FormData! Your model does not have a ${fileAttributeName} property!`);const formData=new FormData;for(const key in model)if(key===fileAttributeName){switch(model[fileAttributeName].constructor.name){case"FileList":formData.append(key,model[fileAttributeName][0]);break;case"File":formData.append(key,model[fileAttributeName])}}else model[key]&&formData.append(key,model[key]);return formData}var map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),environment=__webpack_require__("./src/environments/environment.ts");let BaseService=class BaseService{constructor(http,baseUrl){this.http=http,this.apiUrl=environment.c.apiUrl,this.baseUrl=`${this.apiUrl}/${baseUrl}`}list(){return this.http.get(`${this.baseUrl}/`).pipe((0,map.T)(entries=>entries.map(entry=>this.parseEntity(entry))))}campaignList(campaign){return this.http.get(`${this.baseUrl}/${campaign}/overview/`).pipe((0,map.T)(entries=>entries.map(entry=>this.parseOverviewEntity(entry))))}campaignDetailList(campaign){return this.http.get(`${this.baseUrl}/${campaign}/`).pipe((0,map.T)(entries=>entries.map(entry=>this.parseEntity(entry))))}create(data){return this.http.post(`${this.baseUrl}/`,data).pipe((0,map.T)(entry=>this.parseEntity(entry)))}update(pk,data){return this.http.put(`${this.baseUrl}/pk/${pk}/`,data).pipe((0,map.T)(entry=>this.parseEntity(entry)))}read(pk){return this.http.get(`${this.baseUrl}/pk/${pk}/`).pipe((0,map.T)(entry=>this.parseEntity(entry)))}readByParam(campaign,params){if("string"!=typeof params.name)throw console.error("The params you used in the service"),console.error(params),'Invalid params exception. You tried to use the base readByParams of GenericService with a parameter \n      object without the "name" attribute. This indicates your call is more complex than \n      this base implementation is useful for. Overwrite readByParam in the service that inherits from  \n      GenericObjectService and implement the function yourself';return this.http.get(`${this.baseUrl}/${campaign}/${params.name}/`).pipe((0,map.T)(entry=>this.parseEntity(entry)))}delete(pk){return this.http.delete(`${this.baseUrl}/pk/${pk}/`)}patch(pk,data){return this.http.patch(`${this.baseUrl}/pk/${pk}/`,data).pipe((0,map.T)(entry=>this.parseEntity(entry)))}sortList(entries,sortProperty){return entries.sort((a,b)=>{const aVal=a[sortProperty],bVal=b[sortProperty];return aVal===bVal?0:null==aVal?-1:null==bVal||aVal>bVal?1:-1})}static#_=this.ctorParameters=()=>[{type:module_CBsxN_3E.Qq},{type:String}]};BaseService=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg._qm)({providedIn:"root"})],BaseService);let CampaignService=class CampaignService extends BaseService{constructor(http){super(http,"campaign")}campaignOverview(){return this.http.get(`${this.baseUrl}/overview/`).pipe((0,shareReplay.t)(1))}create(data){const campaignData=this.processCampaignData(data);return super.create(campaignData)}update(pk,data){const campaignData=this.processCampaignData(data);return super.update(pk,campaignData)}patch(pk,data){const campaignData=this.processCampaignData(data);return super.patch(pk,campaignData)}processCampaignData(userModel){const hasNewIcon=this.hasImageSelected(userModel.icon),hasNewBackgroundImage=this.hasImageSelected(userModel.background_image);if(hasNewIcon||hasNewBackgroundImage){if(!hasNewIcon&&hasNewBackgroundImage){delete userModel.icon;return convertSingleFileModelToFormData(userModel,"background_image")}if(hasNewIcon&&!hasNewBackgroundImage){delete userModel.background_image;return convertSingleFileModelToFormData(userModel,"icon")}return function convertMultiFileModelToFormData(model,fileAttributeNames){fileAttributeNames.forEach(name=>{if(!model.hasOwnProperty(name))throw`Can't convert object to FormData! Your model does not have a ${name} property!`});const formData=new FormData;for(const key in model)if(fileAttributeNames.includes(key)){const value=model[key];switch(value.constructor.name){case"File":formData.append(key,value);break;case"FileList":formData.append(key,value[0])}}else model[key]&&formData.append(key,model[key]);return formData}(userModel,["background_image","icon"])}{delete userModel.icon,delete userModel.background_image;const formData=new FormData;return Object.keys(userModel).forEach(key=>formData.append(key,userModel[key])),formData}}hasImageSelected(imageFieldValue){return"FileList"===imageFieldValue.constructor.name||"File"===imageFieldValue.constructor.name}delete(){throw"You can not delete a campaign, please use 'deactivate' instead"}deactivate(pk){return super.delete(pk)}statistics(campaign_name){const statisticsUrl=`${this.apiUrl}/admin/statistics/${campaign_name}`;return this.http.get(statisticsUrl)}readByParam(campaign){return this.http.get(`${this.baseUrl}/${campaign}/`)}addGuest(campaign,user){const requestBody={action:"add_guest",user};return this.http.patch(`${this.baseUrl}/${campaign}/members/`,requestBody)}addMember(campaign,user){const requestBody={action:"add_member",user};return this.http.patch(`${this.baseUrl}/${campaign}/members/`,requestBody)}addAdmin(campaign,user){const requestBody={action:"add_admin",user};return this.http.patch(`${this.baseUrl}/${campaign}/members/`,requestBody)}removeGuest(campaign,user){const requestBody={action:"remove_guest",user};return this.http.patch(`${this.baseUrl}/${campaign}/members/`,requestBody)}removeMember(campaign,user){const requestBody={action:"remove_member",user};return this.http.patch(`${this.baseUrl}/${campaign}/members/`,requestBody)}removeAdmin(campaign,user){const requestBody={action:"remove_admin",user};return this.http.patch(`${this.baseUrl}/${campaign}/members/`,requestBody)}addEmptySearchResponse(responseModel){const emptySearchUrl=`${this.apiUrl}/emptysearchresponse/`;return this.http.post(emptySearchUrl,responseModel)}deleteEmptySearchResponse(emptySearchResponsePk){return this.http.delete(`${this.apiUrl}/emptysearchresponse/pk/${emptySearchResponsePk}/`)}parseEntity(data){return data}parseOverviewEntity(data){return data}static#_=this.ctorParameters=()=>[{type:module_CBsxN_3E.Qq}]};CampaignService=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg._qm)({providedIn:"root"})],CampaignService);var Subject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),ReplaySubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js"),rxjs_operators=__webpack_require__("./src/utils/rxjs-operators.ts");let GlobalUrlParamsService=class GlobalUrlParamsService{constructor(){this.campaignSetTrigger$=new Subject.B,this.currentRouteSnapshot$=new ReplaySubject.m(1),this.campaignNameParam$=this.currentRouteSnapshot$.pipe((0,map.T)(snapshot=>snapshot?.params.campaign),(0,rxjs_operators.cY)("campaignName"))}nextSnapshot(snapshot){this.currentRouteSnapshot$.next(snapshot)}};GlobalUrlParamsService=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg._qm)({providedIn:"root"})],GlobalUrlParamsService);var token_service=__webpack_require__("./src/app/_services/utils/token.service.ts"),auth_store=__webpack_require__("./src/app/auth.store.ts");function hasRoleOrBetter(role,minimumRole){switch(minimumRole){case"member":return["member","admin"].includes(role);case"admin":return"admin"===role;case"guest":return["member","admin","guest"].includes(role);default:return!1}}const SSRDefaultScreenSize$=(0,of.of)({height:600,width:600}),initialGlobalState={contentScrollEvents:void 0,currentCampaign:void 0,campaigns:void 0,isLoadingPage:!1},GlobalStore=(0,ngrx_signals.Eu)((0,ngrx_signals.Q2)(initialGlobalState),(0,ngrx_signals.QO)(state=>{const authStore=(0,root_effect_scheduler_DCy1y1b8.WQX)(auth_store.a),screenSize$=!!document?new Observable.c(observer=>{const resizeObserver=new ResizeObserver(entries=>{for(const entry of entries)observer.next({width:entry.contentRect.width,height:entry.contentRect.height})});return resizeObserver.observe(document.body),()=>resizeObserver.disconnect()}):SSRDefaultScreenSize$;return{screenSize:(0,rxjs_interop.ot)(screenSize$),campaignName:(0,resource_BarKSp_3.EW)(()=>state.currentCampaign()?.name),currentCampaignRole:(0,resource_BarKSp_3.EW)(()=>{const currentCampaign=state.currentCampaign();if(null!=currentCampaign)return authStore.getCampaignRole(currentCampaign.name)})}}),(0,ngrx_signals.RI)(store=>{const tokenService=(0,root_effect_scheduler_DCy1y1b8.WQX)(token_service.B),campaignService=(0,root_effect_scheduler_DCy1y1b8.WQX)(CampaignService),isOnline=(0,rxjs_interop.ot)((0,root_effect_scheduler_DCy1y1b8.WQX)(online_service.D).online$),authStore=(0,root_effect_scheduler_DCy1y1b8.WQX)(auth_store.a);return{isCampaignMember:campaignName=>{campaignName=campaignName??store.campaignName();const userData=authStore.authData();if(null==userData)return!1;const role=tokenService.getCampaignRole(userData,campaignName);return authStore.isGlobalAdmin()||"guest"===role},isCampaignAdmin:campaignName=>{campaignName=campaignName??store.campaignName();const userData=authStore.authData();if(null==userData)return!1;const role=tokenService.getCampaignRole(userData,campaignName);return authStore.isGlobalAdmin()||"admin"===role},isCampaignGuest:campaignName=>{campaignName=campaignName??store.campaignName();const userData=authStore.authData();if(null==userData)return!1;const role=tokenService.getCampaignRole(userData,campaignName);return authStore.isGlobalAdmin()||"guest"===role},canPerformActionsOfRole:minimumRole=>{const hasRolePermissions=(0,resource_BarKSp_3.EW)(()=>{const currentRole=store.currentCampaignRole();return null!=currentRole&&hasRoleOrBetter(currentRole,minimumRole)});return(0,resource_BarKSp_3.EW)(()=>hasRolePermissions()&&!!isOnline())},loadCampaignOverview:()=>{campaignService.campaignOverview().pipe((0,take.s)(1)).subscribe(campaigns=>(0,ngrx_signals.M8)(store,{campaigns}))},fireScrollEvent:event=>{(0,ngrx_signals.M8)(store,{contentScrollEvents:event})},trackIsPageLoading:(0,ngrx_signals_rxjs_interop.o)((0,pipe.F)((0,ngrx_operators.Hn)({next:isLoading=>(0,ngrx_signals.M8)(store,{isLoadingPage:isLoading}),error:err=>{(0,logging.R)(GlobalStore.name,"Error tracking loading state of page",err),(0,ngrx_signals.M8)(store,{isLoadingPage:!1})}}))),logout:()=>{(0,ngrx_signals.M8)(store,{campaigns:void 0,currentCampaign:void 0,contentScrollEvents:void 0,isLoadingPage:!1}),authStore.logout()}}}),(0,ngrx_signals.TK)(store=>{const paramsService=(0,root_effect_scheduler_DCy1y1b8.WQX)(GlobalUrlParamsService);return{onInit:()=>{const campaignParam$=paramsService.campaignNameParam$.pipe((0,rxjs_interop.pQ)()),campaignParam=(0,rxjs_interop.ot)(campaignParam$);(0,resource_BarKSp_3.QZ)(()=>{const campaigns=store.campaigns(),currentCampaignName=campaignParam(),currentCampaign=campaigns?.find(campaign=>campaign.name===currentCampaignName);(0,ngrx_signals.M8)(store,{campaigns,currentCampaign})})}}}))},"./src/app/navigation.store.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>NavigationStore});var root_effect_scheduler_DCy1y1b8=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),router_CsukTOog=__webpack_require__("./node_modules/@angular/router/fesm2022/router-CsukTOog.mjs"),ngrx_signals=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals.mjs"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),lift=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/lift.js"),OperatorSubscriber=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js");var rxjs_operators=__webpack_require__("./src/utils/rxjs-operators.ts");const NavigationStore=(0,ngrx_signals.Eu)((0,ngrx_signals.pq)(()=>{const router=(0,root_effect_scheduler_DCy1y1b8.WQX)(router_CsukTOog.Ix);return{currentRoute$:router.events.pipe((0,filter.p)(event=>event instanceof router_CsukTOog.wF),(0,map.T)(()=>router.routerState.snapshot.root),(0,map.T)(route=>{for(;route.firstChild;)route=route.firstChild;return route}),(0,rxjs_operators.cY)("trackRoute")),history$:router.events.pipe((0,filter.p)(event=>event instanceof router_CsukTOog.ld),(0,map.T)(event=>event.url),(0,lift.N)(function(source,subscriber){var prev,hasPrev=!1;source.subscribe((0,OperatorSubscriber._)(subscriber,function(value){var p=prev;prev=value,hasPrev&&subscriber.next([p,value]),hasPrev=!0}))}),(0,map.T)(([priorRoute,currentRoute])=>({currentRoute,priorRoute})))}}),(0,ngrx_signals.QO)(state=>{const history=(0,rxjs_interop.ot)(state.history$);return{currentRoute:(0,rxjs_interop.ot)(state.currentRoute$),priorUrl:(0,resource_BarKSp_3.EW)(()=>history()?.priorRoute),currentUrl:(0,resource_BarKSp_3.EW)(()=>history()?.currentRoute)}}))}}]);