(self.webpackChunknimstoryfont_gui=self.webpackChunknimstoryfont_gui||[]).push([[9439],{"./src/app/design/organisms/quote/quote.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".field {\n  margin-bottom: var(--spacer-3);\n}\n.field__controls {\n  display: flex;\n  flex-direction: row;\n  gap: var(--spacer-4);\n  margin-top: var(--spacer-3);\n}\n.field__control {\n  width: fit-content;\n}\n\n.quote {\n  border-left: solid 4px var(--bs-white);\n  padding: var(--spacer-2) var(--spacer-0) var(--spacer-1) var(--spacer-4);\n}\n.quote__description {\n  margin: var(--spacer-3) var(--spacer-0) var(--spacer-3) var(--spacer-3);\n}\n.quote__content {\n  font-style: italic;\n  margin: 0;\n  padding: 0;\n  border: none;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/organisms/quote/quote.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{w:()=>QuoteComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var quote_componentngResource=__webpack_require__("./src/app/design/organisms/quote/quote.component.scss?ngResource"),quote_componentngResource_default=__webpack_require__.n(quote_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),root_effect_scheduler_DCy1y1b8=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),routing_service=__webpack_require__("./src/app/_services/routing.service.ts"),router_module_DTmwsUYo=__webpack_require__("./node_modules/@angular/router/fesm2022/router_module-DTmwsUYo.mjs"),ng_bootstrap=__webpack_require__("./node_modules/@ng-bootstrap/ng-bootstrap/fesm2022/ng-bootstrap.mjs"),button_component=__webpack_require__("./src/app/design/atoms/button/button.component.ts"),separator_component=__webpack_require__("./src/app/design/atoms/separator/separator.component.ts"),spinner_component=__webpack_require__("./src/app/design/atoms/spinner/spinner.component.ts"),molecules=__webpack_require__("./src/app/design/molecules/index.ts"),clipboard=__webpack_require__("./src/utils/clipboard.ts"),DOM=__webpack_require__("./src/utils/DOM.ts"),button_link_component=__webpack_require__("./src/app/design/atoms/button-link/button-link.component.ts"),toast_service=__webpack_require__("./src/app/design/organisms/toast-overlay/toast.service.ts");let QuoteComponent=class QuoteComponent{constructor(routingService,toastService){this.routingService=routingService,this.toastService=toastService,this.quote=(0,core.input)(),this.quoteControlsBlacklist=(0,core.input)([]),this._quoteControlsBlacklist=(0,resource_BarKSp_3.EW)(()=>new Set(this.quoteControlsBlacklist())),this.character=core.input.required(),this.campaignCharacters=core.input.required(),this.canCreate=(0,core.input)(!1),this.canUpdate=(0,core.input)(!1),this.canDelete=(0,core.input)(!1),this.quoteDelete=(0,core.output)(),this.quoteCreate=(0,core.output)(),this.quoteUpdate=(0,core.output)(),this.connectionDelete=(0,core.output)(),this.connectionCreate=(0,core.output)(),this.refreshQuote=(0,core.output)(),this.state="DISPLAY",this.quoteId=(0,DOM.n)(),this.badgeEntries=(0,resource_BarKSp_3.EW)(()=>this.parseConnection(this.quote()?.connections??[])),this.campaignName=(0,resource_BarKSp_3.EW)(()=>this.character().campaign_details?.name),this.isLoadingQuote=(0,root_effect_scheduler_DCy1y1b8.vPA)(!1),this.quoteOverviewUrl=(0,resource_BarKSp_3.EW)(()=>this.routingService.getRoutePath("quote-overview",{name:this.character.name,campaign:this.campaignName})),this.hasQuote=(0,resource_BarKSp_3.EW)(()=>!!this.quote()),this.quoteLabel=(0,resource_BarKSp_3.EW)(()=>`Quotes of ${this.character()?.name}`),this._quoteControlls=(0,resource_BarKSp_3.EW)(()=>[{controlKind:"REFRESH",isVisible:this.hasQuote(),title:"Load new quote",type:"INFO",icon:"refresh",config:{kind:"CLICK",onClick:()=>this.getNextRandomQuote()}},{controlKind:"UPDATE",isVisible:this.hasQuote()&&this.canUpdate(),title:"Edit Quote",type:"SECONDARY",icon:"pencil",config:{kind:"CLICK",onClick:()=>this.quoteUpdate.emit(this.quote())}},{controlKind:"CREATE",isVisible:this.canCreate(),title:this.hasQuote()?"Create Quote":void 0,label:this.hasQuote()?void 0:"Create Quote",type:"PRIMARY",icon:"plus",config:{kind:"CLICK",onClick:()=>this.quoteCreate.emit()}},{controlKind:"DELETE",isVisible:!!this.quote()&&this.canDelete(),title:"Delete Quote",type:"DANGER",icon:"trash",config:{kind:"CLICK",onClick:()=>this.quoteDelete.emit(this.quote())}},{controlKind:"COPY",isVisible:!!this.quote(),title:"Copy Quote to Clipboard",type:"DARK",icon:"copy",config:{kind:"CLICK",onClick:()=>this.copyQuoteToClipboard()}},{controlKind:"LIST",isVisible:!!this.quote(),title:"See all quotes",type:"SECONDARY",icon:"th-list",config:{kind:"LINK",link:this.routingService.getRoutePath("quote-overview",{name:this.character().name,campaign:this.campaignName()})}}]),this.quoteControlls=(0,resource_BarKSp_3.EW)(()=>this._quoteControlls().filter(ctrl=>ctrl.isVisible).filter(ctrl=>!this._quoteControlsBlacklist().has(ctrl.controlKind)))}ngOnChanges(){this.isLoadingQuote.set(!1)}onConnectionDelete(connection){this.canDelete()&&this.connectionDelete.emit(connection)}onConnectionCreate(character){if(!this.canCreate()||!this.quote())return;const newConnection={quote:this.quote()?.pk,character:character.pk};this.connectionCreate.emit(newConnection)}getNextRandomQuote(){this.isLoadingQuote.set(!0),this.refreshQuote.emit()}parseConnection(connections){return connections.map(con=>{const characterName=con.character_details?.name;return{text:characterName,badgeValue:con,link:this.routingService.getRoutePath("character",{name:characterName,campaign:this.campaignName()})}})}copyQuoteToClipboard(){const quote=this.quote();if(!quote)return;const text=`${quote.quote.split("<br />").map(line=>`>${line.trim().trimStart()}`).join("<br />")}\n>${`- ${quote.description} `}`;(0,clipboard.l)(text),this.toastService.addToast({dismissMs:1500,type:"SUCCESS",onToastClick:dismiss=>dismiss(),body:{text:"Copied quote to clipboard",icon:"check"}})}static#_=this.ctorParameters=()=>[{type:routing_service.O},{type:toast_service.f}];static#_2=this.propDecorators={quote:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"quote",required:!1,transform:void 0}]}],quoteControlsBlacklist:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"quoteControlsBlacklist",required:!1,transform:void 0}]}],character:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"character",required:!0,transform:void 0}]}],campaignCharacters:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"campaignCharacters",required:!0,transform:void 0}]}],canCreate:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"canCreate",required:!1,transform:void 0}]}],canUpdate:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"canUpdate",required:!1,transform:void 0}]}],canDelete:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"canDelete",required:!1,transform:void 0}]}],quoteDelete:[{type:debug_node_JnOYh9kg.k7i,args:["quoteDelete"]}],quoteCreate:[{type:debug_node_JnOYh9kg.k7i,args:["quoteCreate"]}],quoteUpdate:[{type:debug_node_JnOYh9kg.k7i,args:["quoteUpdate"]}],connectionDelete:[{type:debug_node_JnOYh9kg.k7i,args:["connectionDelete"]}],connectionCreate:[{type:debug_node_JnOYh9kg.k7i,args:["connectionCreate"]}],refreshQuote:[{type:debug_node_JnOYh9kg.k7i,args:["refreshQuote"]}]}};QuoteComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"app-quote",template:'@if (!isLoadingQuote()) {\n  <section class="field">\n    @let quoteVal = quote();\n    @if (quoteVal) {\n      <div class="field__quote quote" [attr.aria-label]="quoteLabel()">\n        <figure class="m-0">\n          \x3c!-- Quote --\x3e\n          <blockquote class="quote__content">\n            <p [innerHTML]="quoteVal.quote"></p>\n          </blockquote>\n          <figcaption class="quote__description">\n            \x3c!-- Quote Description --\x3e\n            @if (quoteVal.description) {\n              <p class="m-0" [innerHTML]="\'- \' + quoteVal.description"></p>\n            } @else {\n              - {{ character().name }}\n            }\n          </figcaption>\n        </figure>\n        <app-separator />\n\n        \x3c!-- Quote Connections --\x3e\n        <div class="quote__connections">\n          <app-badge-list\n            [entries]="badgeEntries()"\n            [label]="\'Characters\'"\n            [createOptions]="{\n              kind: \'SELECT\',\n              formFieldLabel: \'Characters\',\n              config: {\n                options: campaignCharacters(),\n                labelProp: \'name\',\n                valueProp: \'pk\',\n              },\n            }"\n            [canCreate]="canCreate()"\n            [canDelete]="canDelete()"\n            [cancelButtonType]="\'DARK\'"\n            (entryCreate)="onConnectionCreate($event)"\n            (entryDelete)="onConnectionDelete($event)"\n          ></app-badge-list>\n        </div>\n      </div>\n    }\n\n    \x3c!-- Quote Refresh/Create/Edit/Delete Icons --\x3e\n    <footer class="field__controls">\n      @for (control of quoteControlls(); track $index) {\n        @switch (control.config.kind) {\n          @case ("CLICK") {\n            <button\n              btn\n              class="field__control"\n              [attr.aria-label]="control.title"\n              [attr.title]="control.title"\n              [kind]="control.type"\n              [text]="control.label"\n              [icon]="control.icon"\n              (clicked)="control.config.onClick()"\n            ></button>\n          }\n          @case ("LINK") {\n            <a\n              btn\n              class="field__control"\n              [attr.aria-label]="control.title"\n              [ngbTooltip]="control.title"\n              [kind]="control.type"\n              [text]="control.label"\n              [icon]="control.icon"\n              [routerLink]="control.config.link"\n            >\n            </a>\n          }\n        }\n      }\n    </footer>\n  </section>\n}\n\n<ng-template #loading>\n  <app-spinner></app-spinner>\n</ng-template>\n',imports:[molecules.pn,separator_component.F,button_component.Q,button_link_component.W,router_module_DTmwsUYo.Wk,spinner_component.t,ng_bootstrap.md],changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,styles:[quote_componentngResource_default()]})],QuoteComponent)},"./src/app/design/organisms/quote/quote.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,NoPermission:()=>NoPermission,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _angular_router_testing__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/router/fesm2022/testing.mjs"),storybook_actions__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("storybook/actions"),_storybook_angular__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs");const __WEBPACK_DEFAULT_EXPORT__={title:"DesignSystem/Organisms/QuoteComponent",component:__webpack_require__("./src/app/design/organisms/quote/quote.component.ts").w,decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_1__.Iz)({imports:[_angular_router_testing__WEBPACK_IMPORTED_MODULE_3__.c1]})],args:{quote:{quote:"In the darkest of times, the light within us shines the brightest.",description:"Said by a wise old wizard to a young hero about to embark on a perilous quest.",pk:1,session:3,creation_datetime:"2023-04-22T12:00:00.000Z",update_datetime:"2023-04-23T12:00:00.000Z",session_details:{pk:3,is_main_session:!0,is_main_session_int:1,session_number:3,session_date:"2023-04-20",start_day:1,end_day:5,name:"The Quest for the Sacred Amulet",title:"The Quest",creation_datetime:"2023-04-22T12:00:00.000Z",update_datetime:"2023-04-23T12:00:00.000Z",campaign:1,campaign_details:{name:"Aldrune",pk:1},has_recording:!1,diaryentries:[]},encounter:2,connections:[{character:1,character_details:{pk:1,name:"Gandalf",name_full:"Gandalf the Grey"},quote:2,pk:2},{character:2,character_details:{pk:2,name:"Frodo",name_full:"Frodo Baggins"},quote:3,pk:3}]},character:{getAbsoluteRouterUrl:()=>"/dummy/url",player_character:!1,alive:!0,name:"Gandalf",title:"Gandalf the Grey",gender:"Male",race:"Maia",creation_datetime:"2023-04-22T12:00:00.000Z",update_datetime:"2023-04-23T12:00:00.000Z",description:"A wise and powerful wizard, Gandalf the Grey is a member of the Fellowship of the Ring and a key figure in the fight against the Dark Lord Sauron.",organizations:[{pk:1,name:"The White Council",organization_id:1,role:"Member"},{pk:2,name:"The Fellowship of the Ring",organization_id:2,role:"Member"}],current_location:3,current_location_details:{pk:3,name_full:"Moria",parent_location:"Middle-earth"},items:[{pk:1,name:"Glamdring"},{pk:2,name:"Staff"}],encounters:[{name:"The Council of Elrond",creation_datetime:"2023-04-22T12:00:00.000Z",update_datetime:"2023-04-23T12:00:00.000Z",title:"Council of Elrond",diaryentry:50,order_index:20,encounterConnections:[{pk:1,encounter:2,character:3},{pk:2,encounter:3,character:4}],description:"At the Council of Elrond, Gandalf reveals the true nature of the One Ring and urges the Fellowship to destroy it in the fires of Mount Doom.",pk:1,campaign_details:{name:"Aldrune",id:1}},{name:"The Battle of Helm's Deep",title:"The Battle of Helm's Deep",diaryentry:20,order_index:30,creation_datetime:"2023-04-23T12:00:00.000Z",update_datetime:"2023-04-24T12:00:00.000Z",encounterConnections:[{pk:324,encounter:223,encounter_details:{name:"Main Session 6 - A new job",name_full:"Main Session 6 - A new job",pk:223},character:43,character_details:{name:"Aliana Sterent",name_full:"Aliana Sterent",pk:43}},{pk:325,encounter:223,encounter_details:{name:"Main Session 6 - A new job",name_full:"Main Session 6 - A new job",pk:223},character:29,character_details:{name:"Ateula",name_full:"Ateula",pk:29}}],description:"Gandalf arrives at Helm's Deep with reinforcements and turns the tide of the battle against Saruman's forces.",pk:2,campaign_details:{name:"Aldrune",id:1}}],images:[],player_class_connections:[{pk:1,player_class:8,character:5,player_class_details:{update_datetime:"2023-04-24T12:00:00.000Z",name:"Paladin",pk:8}}],campaign:1,campaign_details:{id:1,name:"The War of the Ring"}},canCreate:!0,canUpdate:!0,canDelete:!0,campaignCharacters:[{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Gandalf",pk:1,name_full:"Gandalf the Grey",player_character:!0,images:["https://example.com/images/lirien1.jpg"],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Frodo",pk:2,name_full:"Frodo Baggins",player_character:!0,images:[],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Gimli",pk:3,name_full:"Gimli son of GlÃ³in",player_character:!1,images:[],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Legolas",pk:4,name_full:"Legolas Greenleaf",player_character:!1,images:["https://example.com/images/lirien1.jpg"],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Bilbo",pk:5,name_full:"Bilbo Baggins",player_character:!1,images:[],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Aragorn",pk:6,name_full:"Aragorn son of Arathorn",player_character:!1,images:["https://example.com/images/lirien1.jpg"],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Saruman",pk:7,name_full:"Saruman the White",player_character:!1,images:[],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Sif",pk:18,name_full:"Sif the Swift",description:"Sif is a skilled warrior known for her lightning-fast strikes and agility. She is fiercely loyal to her friends and will stop at nothing to protect them.",update_datetime:"2022-03-15T10:30:00.000Z",player_character:!0,images:[],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Gorin",pk:19,name_full:"Gorin Ironfist",description:"Gorin is a dwarf from the Iron Hills, known for his strength and unwavering determination. He has a fondness for ale and a good brawl.",update_datetime:"2022-02-23T14:15:00.000Z",player_character:!0,images:["https://example.com/images/lirien1.jpg","https://example.com/images/lirien1.jpg"],campaign_details:{id:567,name:"Game of Thrones RPG"}},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Lirien",pk:20,name_full:"Lirien Windrider",description:"Lirien is an elven archer, renowned for her skill with the bow. She is fiercely independent and often clashes with authority figures.",update_datetime:"2022-03-20T08:45:00.000Z",player_character:!0,images:["https://example.com/images/lirien1.jpg"],campaign_details:{id:567,name:"Game of Thrones RPG"}}]}},Template=args=>({props:{...args,quoteDelete:(0,storybook_actions__WEBPACK_IMPORTED_MODULE_0__.action)("quoteDelete"),quoteCreate:(0,storybook_actions__WEBPACK_IMPORTED_MODULE_0__.action)("quoteCreate"),quoteUpdate:(0,storybook_actions__WEBPACK_IMPORTED_MODULE_0__.action)("quoteUpdate"),refreshQuote:(0,storybook_actions__WEBPACK_IMPORTED_MODULE_0__.action)("refreshQuote"),connectionDelete:(0,storybook_actions__WEBPACK_IMPORTED_MODULE_0__.action)("connectionDelete"),connectionCreate:(0,storybook_actions__WEBPACK_IMPORTED_MODULE_0__.action)("connectionCreate")}}),Default=Template.bind({});Default.args={};const NoPermission=Template.bind({});NoPermission.args={canCreate:!1,canUpdate:!1,canDelete:!1};const __namedExportsOrder=["Default","NoPermission"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => ({\n  props: {\n    ...args,\n    quoteDelete: action('quoteDelete'),\n    quoteCreate: action('quoteCreate'),\n    quoteUpdate: action('quoteUpdate'),\n    refreshQuote: action('refreshQuote'),\n    connectionDelete: action('connectionDelete'),\n    connectionCreate: action('connectionCreate')\n  }\n})",...Default.parameters?.docs?.source}}},NoPermission.parameters={...NoPermission.parameters,docs:{...NoPermission.parameters?.docs,source:{originalSource:"args => ({\n  props: {\n    ...args,\n    quoteDelete: action('quoteDelete'),\n    quoteCreate: action('quoteCreate'),\n    quoteUpdate: action('quoteUpdate'),\n    refreshQuote: action('refreshQuote'),\n    connectionDelete: action('connectionDelete'),\n    connectionCreate: action('connectionCreate')\n  }\n})",...NoPermission.parameters?.docs?.source}}}}}]);