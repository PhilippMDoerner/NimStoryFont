(self.webpackChunknimstoryfont_gui=self.webpackChunknimstoryfont_gui||[]).push([[9434],{"./src/app/_directives/hotkey.directive.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{G:()=>HotkeyDirective});var tslib__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@ng-bootstrap/ng-bootstrap/fesm2022/ng-bootstrap.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),rxjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js"),rxjs__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),rxjs__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/empty.js"),rxjs__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/withLatestFrom.js"),rxjs__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),src_utils_rxjs_operators__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/rxjs-operators.ts"),_functions_keyMapper__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/app/_functions/keyMapper.ts"),_services_hotkey_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/app/_services/hotkey.service.ts"),_services_screen_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/app/_services/screen.service.ts");let HotkeyDirective=class HotkeyDirective{constructor(){if(this.tooltip=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.WQX)(_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_4__.md),this.hotkeyService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.WQX)(_services_hotkey_service__WEBPACK_IMPORTED_MODULE_1__.Q),this.modalService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.WQX)(_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_4__.Bq),this.element=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.aKT),this.hotkeyAction=_angular_core__WEBPACK_IMPORTED_MODULE_6__.input.required(),this.watchOptions=(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.input)({isModalAction:!1,suppressEvent:!1}),this.actionDisabled=(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.input)(!1),this.description=(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.input)(),this.actionTriggered=(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.output)(),this.watchOptions$=(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.br)(this.watchOptions).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_8__.T)(options=>({isModalAction:!1,suppressEvent:!1,eventSource:options.useLocalEventSource?this.element.nativeElement:void 0,...options}))),this.hotkeyCombination$=(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.br)(this.hotkeyAction).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.n)(action=>action?this.hotkeyService.getKeySequence(action):(0,rxjs__WEBPACK_IMPORTED_MODULE_10__.of)(void 0))),this.ariaShortcutText=(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.ot)((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.z)({combo:this.hotkeyCombination$,watchOptions:this.watchOptions$}).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_8__.T)(({combo,watchOptions})=>{if(!combo)return;return`${(0,_functions_keyMapper__WEBPACK_IMPORTED_MODULE_12__.d)(combo,!0)}${!!watchOptions.eventSource?"(Active on focus)":""}`}))),this.hotkeyCombination=(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.ot)(this.hotkeyCombination$),this.tooltipText=(0,_angular_core__WEBPACK_IMPORTED_MODULE_13__.EW)(()=>{const hotkeyCombo=this.hotkeyCombination();if(!hotkeyCombo)return;const comboStr=(0,_functions_keyMapper__WEBPACK_IMPORTED_MODULE_12__.d)(hotkeyCombo,!0),hotkeyDescription=this.description();return hotkeyDescription?`${comboStr}: ${hotkeyDescription}`:comboStr}),(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.WQX)(_services_screen_service__WEBPACK_IMPORTED_MODULE_2__.i).isMobile())return;this.configureTooltip(this.element),this.keepTooltipInSync();const isDisabled$=(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.br)(this.actionDisabled).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_14__.Z)(!1));(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.z)({action:(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.br)(this.hotkeyAction),watchOptions:this.watchOptions$}).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.n)(({action,watchOptions})=>action?this.hotkeyService.watchAction(action,watchOptions):rxjs__WEBPACK_IMPORTED_MODULE_15__.w),(0,rxjs__WEBPACK_IMPORTED_MODULE_16__.E)(isDisabled$,this.watchOptions$),(0,rxjs__WEBPACK_IMPORTED_MODULE_17__.p)(([,isDisabled,watchOptions])=>{if(isDisabled)return!1;const hasOpenModals=this.modalService.hasOpenModals(),canSeeActionInOpenModal=hasOpenModals&&!!watchOptions.isModalAction;return!hasOpenModals||canSeeActionInOpenModal}),(0,src_utils_rxjs_operators__WEBPACK_IMPORTED_MODULE_0__.cY)("Emitting Hotkey"),(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.pQ)()).subscribe(()=>this.actionTriggered.emit({host:this.element.nativeElement}))}configureTooltip(element){this.tooltip.triggers="",this.tooltip.tooltipClass="z-1001",this.tooltip.positionTarget=element.nativeElement}syncTooltipOpenState(showTooltip){showTooltip?this.tooltip.open():this.tooltip.close()}keepTooltipInSync(){(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.z)({action:(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.br)(this.hotkeyAction),watchOptions:this.watchOptions$,isDisabled:(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.br)(this.actionDisabled)}).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.n)(({action,watchOptions,isDisabled})=>isDisabled||!action?(0,rxjs__WEBPACK_IMPORTED_MODULE_10__.of)(!1):this.hotkeyService.hasVisibleTooltip(watchOptions.isModalAction)),(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.pQ)()).subscribe(showTooltip=>this.syncTooltipOpenState(showTooltip)),(0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.br)(this.tooltipText).pipe((0,_angular_core_rxjs_interop__WEBPACK_IMPORTED_MODULE_7__.pQ)()).subscribe(tooltipText=>this.tooltip.ngbTooltip=tooltipText)}static#_=this.ctorParameters=()=>[];static#_2=this.propDecorators={hotkeyAction:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_5__.pde,args:[{isSignal:!0,alias:"hotkeyAction",required:!0,transform:void 0}]}],watchOptions:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_5__.pde,args:[{isSignal:!0,alias:"watchOptions",required:!1,transform:void 0}]}],actionDisabled:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_5__.pde,args:[{isSignal:!0,alias:"actionDisabled",required:!1,transform:void 0}]}],description:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_5__.pde,args:[{isSignal:!0,alias:"description",required:!1,transform:void 0}]}],actionTriggered:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_5__.k7i,args:["actionTriggered"]}]}};HotkeyDirective=(0,tslib__WEBPACK_IMPORTED_MODULE_18__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.WLR)({selector:"[hotkeyAction]",providers:[_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_4__.md],host:{"[attr.aria-keyshortcuts]":"ariaShortcutText()"}})],HotkeyDirective)},"./src/app/_functions/keyMapper.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{d:()=>encodeKeyCombination});var src_utils_string__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/string.ts");function encodeKeyCombination(combo,capitalizeKeys=!1){return combo.map(key=>function encodeKey(event,capitalizeKeys=!1){return[event.altKey?"Alt":"",event.ctrlKey?"Ctrl":"",event.metaKey?"Meta":"",event.shiftKey?"Shift":"",event.key.toLowerCase()].filter(label=>label).map(label=>capitalizeKeys?(0,src_utils_string__WEBPACK_IMPORTED_MODULE_0__.ZH)(label):label).join("+")}(key,capitalizeKeys)).join(" + ")}},"./src/app/_models/toast.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{oP:()=>httpErrorToast});var src_utils_clipboard__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/clipboard.ts");function httpErrorToast(err){if(!("number"===err.status?.constructor?.name.toLowerCase()))throw err;const buttons=500===err.status?[{label:"Copy to Clipboard",icon:"clipboard",onClick:()=>(0,src_utils_clipboard__WEBPACK_IMPORTED_MODULE_0__.l)(err.error)}]:[];return{type:"DANGER",body:{text:`\n        <strong> Please copy the error and send it to the developer: </strong>  <br>\n        ${error=err,JSON.stringify(error.error)}\n      `,buttons},header:{text:getErrorHeading(err)}};var error}function getErrorHeading(error){switch(error.status){case 0:case 504:return"This can't be done without an internet connection";case 200:return"The target URL for the requested action does not seem to exist";case 500:return"The server exploded somehow!";default:return"An error occurred"}}},"./src/app/_services/hotkey.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>HotkeyService});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),root_effect_scheduler_DCy1y1b8=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),ng_bootstrap=__webpack_require__("./node_modules/@ng-bootstrap/ng-bootstrap/fesm2022/ng-bootstrap.mjs"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),scan=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/scan.js"),fromEvent=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js"),share=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/share.js"),switchMap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),bufferCount=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/bufferCount.js"),merge=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/merge.js"),timeout=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/timeout.js"),retry=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/retry.js"),take=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/take.js"),repeat=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/repeat.js"),rxjs_operators=__webpack_require__("./src/utils/rxjs-operators.ts"),string=__webpack_require__("./src/utils/string.ts");const MODIFIER_KEYS=new Set(["Alt","Control","AltGraph","Meta","Shift","CapsLock","Escape","Enter","Tab"]),ACTIONS=["create","delete","update","description-update","cancel","jump-to-next-entry","jump-to-prior-entry","search","focus","cut","toggle","show-tooltips","show-onboarding"],DEFAULT_MAPPINGS=(new Set(ACTIONS),{create:{keys:[{key:"c",altKey:!0}],modified:!1},delete:{keys:[{key:"d",altKey:!0}],modified:!1},update:{keys:[{key:"e",altKey:!0}],modified:!1},"description-update":{keys:[{key:"w",altKey:!0}],modified:!1},cancel:{keys:[{key:"q",altKey:!0}],modified:!1},"jump-to-next-entry":{keys:[{key:"ArrowDown",altKey:!0}],modified:!1},"jump-to-prior-entry":{keys:[{key:"ArrowUp",altKey:!0}],modified:!1},search:{keys:[{key:"s",altKey:!0}],modified:!1},focus:{keys:[{key:"f",altKey:!0}],modified:!1},cut:{keys:[{key:"x",altKey:!0}],modified:!1},toggle:{keys:[{key:"r",altKey:!0}],modified:!1},"show-tooltips":{keys:[{key:"g",altKey:!0}],modified:!1},"show-onboarding":{keys:[{key:"o",altKey:!0}],modified:!1}});function parseKeyCombinationStr(str){const keys=str.toLowerCase().split("-").map(keyStr=>function parseKeyStr(str){const segments=str.toLowerCase().split("+"),key=segments.find(segment=>!MODIFIER_KEYS.has((0,string.ZH)(segment)));return key?{key,altKey:segments.includes("alt"),ctrlKey:segments.includes("ctrl"),metaKey:segments.includes("meta"),shiftKey:segments.includes("shift")}:void 0}(keyStr));if(!keys.some(key=>!key))return keys}var resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),ngrx_operators=__webpack_require__("./node_modules/@ngrx/operators/fesm2022/ngrx-operators.mjs"),ngrx_signals=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals.mjs"),ngrx_signals_rxjs_interop=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals-rxjs-interop.mjs"),pipe=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/pipe.js"),tap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js");function toBoolean(value){return"true"===value}var withQueries=__webpack_require__("./src/utils/store/withQueries/index.ts"),keyMapper=__webpack_require__("./src/app/_functions/keyMapper.ts"),toast=__webpack_require__("./src/app/_models/toast.ts"),module_CBsxN_3E=__webpack_require__("./node_modules/@angular/common/fesm2022/module-CBsxN_3E.mjs"),environment=__webpack_require__("./src/environments/environment.ts");let PreferencesService=class PreferencesService{constructor(){this.http=(0,root_effect_scheduler_DCy1y1b8.WQX)(module_CBsxN_3E.Qq),this.apiUrl=environment.c.apiUrl,this.searchPreferenceKey="AldruneSearchPreferences",this.settingsApiUrl=`${this.apiUrl}/user/me/settings`}getGeneralUserMetadata(){return this.getUserMetadata("general").pipe((0,map.T)(entryMap=>{return{hasSeenOnboarding:toBoolean((name="hasSeenOnboarding",entryMap.get(name)))};var name}))}getUserShortcuts(){return this.http.get(`${this.settingsApiUrl}/shortcut/`).pipe((0,map.T)(entries=>entries?.map(entry=>({...entry,value:parseKeyCombinationStr(entry.value)}))))}createUserMetadataEntry(entry){return this.http.post(`${this.settingsApiUrl}/`,entry)}updateUserMetadataEntry(entry){return this.http.put(`${this.settingsApiUrl}/pk/${entry.id}/`,entry)}deleteUserMetadataEntry(entryId){return this.http.delete(`${this.settingsApiUrl}/pk/${entryId}/`).pipe((0,map.T)(()=>{}))}getStoredSearchPreferences(){return this.getStoredPreferences(this.searchPreferenceKey)}storeSearchPreferences(preferences){this.storePreferences(preferences,this.searchPreferenceKey)}getStoredPreferences(key){const preferencesJson=localStorage.getItem(key);return null!=preferencesJson?JSON.parse(preferencesJson):null}storePreferences(preferences,key){const preferencesJson=JSON.stringify(preferences);localStorage.setItem(key,preferencesJson)}getUserMetadata(category){return this.http.get(`${this.settingsApiUrl}/${category}/`).pipe((0,map.T)(entries=>entries.reduce((map,entry)=>(map.set(entry.name,entry.value),map),new Map)))}};PreferencesService=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg._qm)({providedIn:"root"})],PreferencesService);var toast_service=__webpack_require__("./src/app/design/organisms/toast-overlay/toast.service.ts");const UserPreferencesStore=(0,ngrx_signals.Eu)({providedIn:"root"},(0,ngrx_signals.Q2)({updateShortcutsState:"init",deleteShortcutsState:"init"}),(0,withQueries.j)(()=>{const preferencesService=(0,root_effect_scheduler_DCy1y1b8.WQX)(PreferencesService);return{general:()=>preferencesService.getGeneralUserMetadata(),shortcutEntries:()=>preferencesService.getUserShortcuts()}}),(0,ngrx_signals.QO)(state=>({shortcutMappings:(0,resource_BarKSp_3.EW)(()=>{const shortcutEntries=state.shortcutEntries(),modifiedShortcuts=shortcutEntries?.reduce((acc,entry)=>(acc[entry.name]={keys:entry.value,modified:!0},acc),{});return{...DEFAULT_MAPPINGS,...modifiedShortcuts}})})),(0,ngrx_signals.RI)(store=>{const preferencesService=(0,root_effect_scheduler_DCy1y1b8.WQX)(PreferencesService),toastService=(0,root_effect_scheduler_DCy1y1b8.WQX)(toast_service.f);return{createMetaDataEntry:(0,ngrx_signals_rxjs_interop.o)((0,pipe.F)((0,switchMap.n)(entry=>preferencesService.createUserMetadataEntry(entry)),(0,ngrx_operators.Hn)({next:newEntry=>{switch(newEntry.category){case"general":{const nextState={general:{...store.general(),...toGeneralMetadataSlice(newEntry)}};(0,ngrx_signals.M8)(store,nextState);break}}},error:err=>{400===err.status||toastService.addToast((0,toast.oP)(err))}}))),updateShortcut:(0,ngrx_signals_rxjs_interop.o)((0,pipe.F)((0,map.T)(({action,keys})=>{const entry=store.shortcutEntries()?.find(entry=>entry.name===action);return{category:"shortcut",name:action,value:(0,keyMapper.d)(keys),id:entry?.id,user_id:entry?.user_id}}),(0,tap.M)(()=>(0,ngrx_signals.M8)(store,{updateShortcutsState:"loading"})),(0,switchMap.n)(entry=>null==entry.id?preferencesService.createUserMetadataEntry(entry):preferencesService.updateUserMetadataEntry(entry)),(0,map.T)(newEntry=>({...newEntry,value:parseKeyCombinationStr(newEntry.value)})),(0,ngrx_operators.Hn)({next:newEntry=>{const oldList=store.shortcutEntries(),newList=oldList?.filter(entry=>entry.name!==newEntry.name);newList?.push(newEntry),(0,ngrx_signals.M8)(store,{shortcutEntries:newList,updateShortcutsState:"success"})},error:err=>{400===err.status||toastService.addToast((0,toast.oP)(err)),(0,ngrx_signals.M8)(store,{updateShortcutsState:"error"})}}))),resetShortcut:(0,ngrx_signals_rxjs_interop.o)((0,pipe.F)((0,map.T)(action=>store.shortcutEntries()?.find(entry=>entry.name===action)?.id),(0,rxjs_operators.u5)(),(0,tap.M)(()=>(0,ngrx_signals.M8)(store,{deleteShortcutsState:"loading"})),(0,switchMap.n)(entryId=>preferencesService.deleteUserMetadataEntry(entryId).pipe((0,map.T)(()=>entryId))),(0,ngrx_operators.Hn)({next:entryId=>{const oldList=store.shortcutEntries(),newList=oldList?.filter(entry=>entry.id!==entryId);(0,ngrx_signals.M8)(store,{shortcutEntries:newList,deleteShortcutsState:"success"})},error:err=>{400===err.status||toastService.addToast((0,toast.oP)(err)),(0,ngrx_signals.M8)(store,{deleteShortcutsState:"error"})}})))}}));function toGeneralMetadataSlice(newEntry){if("hasSeenOnboarding"===newEntry.name)return{hasSeenOnboarding:toBoolean(newEntry.value)}}let HotkeyService=class HotkeyService{constructor(){this.modalService=(0,root_effect_scheduler_DCy1y1b8.WQX)(ng_bootstrap.Bq),this.preferencesStore=(0,root_effect_scheduler_DCy1y1b8.WQX)(UserPreferencesStore),this.hotkeyMap=this.preferencesStore.shortcutMappings,this.hotkeyMap$=(0,rxjs_interop.br)(this.hotkeyMap),this.globalActions$=this.createActionListener(document.body)}watchAction(action,options={}){return(options.eventSource?this.createActionListener(options.eventSource):this.globalActions$).pipe((0,filter.p)(a=>a===action),(0,filter.p)(()=>this.modalActionFilter(!!options.isModalAction)),(0,map.T)(()=>{}))}hasVisibleTooltip(isModalAction=!1){return this.watchAction("show-tooltips",{isModalAction}).pipe((0,scan.S)(currentIsTooltipVisibleValue=>!currentIsTooltipVisibleValue,!1))}getKeySequence(action){return this.hotkeyMap$.pipe((0,map.T)(hotkeyMap=>hotkeyMap[action].keys))}createKeyListener(eventSource){return(0,fromEvent.R)(eventSource,"keyup").pipe((0,filter.p)(event=>!(event.target instanceof HTMLInputElement||event.target instanceof HTMLTextAreaElement)&&!MODIFIER_KEYS.has(event.key)),(0,rxjs_operators.cY)("keyup"),(0,share.u)())}createActionListener(eventSource){const keyup$=this.createKeyListener(eventSource);return this.hotkeyMap$.pipe((0,map.T)(hotkeyMap=>{const sequences=ACTIONS.map(action=>({sequence:hotkeyMap[action].keys.map(key=>({...key,key:key.key.toLowerCase()})),action}));return sequences.sort((a,b)=>b.sequence.length-a.sequence.length),sequences}),(0,switchMap.n)(hotkeySequences=>{const actionListeners$=hotkeySequences.map(({sequence,action})=>keyup$.pipe((0,bufferCount.S)(sequence.length,1),(0,filter.p)(lastNKeys=>sequence.every((key,index)=>function equals(a,b){return a===b||!(!a||!b)&&a.key===b.key&&(a.altKey??!1)===(b.altKey??!1)&&(a.ctrlKey??!1)===(b.ctrlKey??!1)&&(a.metaKey??!1)===(b.metaKey??!1)&&(a.shiftKey??!1)===(b.shiftKey??!1)}(key,lastNKeys[index]))),(0,map.T)(()=>action),(0,rxjs_operators.cY)("action")));return(0,merge.h)(...actionListeners$).pipe((0,timeout.w)(5e3),(0,retry.L)(),(0,take.s)(1),(0,repeat.u)())}),(0,share.u)())}modalActionFilter(isModalAction){const hasOpenModals=this.modalService.hasOpenModals();return!hasOpenModals||hasOpenModals&&isModalAction}};HotkeyService=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg._qm)({providedIn:"root"})],HotkeyService)},"./src/app/_services/screen.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{i:()=>ScreenService});var tslib__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js"),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/empty.js"),_app_constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/app/app.constants.ts");let ScreenService=class ScreenService{constructor(){this.document=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.qQL),this.resizeEvents$=this.document.defaultView?(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.R)(this.document.defaultView,"resize",{passive:!0}).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.B)(500),(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.T)(()=>this.document.defaultView),(0,rxjs__WEBPACK_IMPORTED_MODULE_5__.Z)(this.document.defaultView)):rxjs__WEBPACK_IMPORTED_MODULE_6__.w,this.windowWidth$=this.resizeEvents$.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.T)(doc=>doc?.innerWidth)),this.windowHeight$=this.resizeEvents$.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.T)(doc=>doc?.innerHeight)),this.isMobile$=this.windowWidth$.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.T)(width=>width&&width<=_app_constants__WEBPACK_IMPORTED_MODULE_0__.kJ))}isMobile(){const windowWidth=this.document.defaultView?.innerWidth;return!!windowWidth&&windowWidth<=_app_constants__WEBPACK_IMPORTED_MODULE_0__.kJ}};ScreenService=(0,tslib__WEBPACK_IMPORTED_MODULE_7__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_8__._qm)({providedIn:"root"})],ScreenService)},"./src/app/app.constants.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{MQ:()=>SCROLL_UP_DISTANCE,Mw:()=>SWIPE_X_THRESHOLD,O5:()=>TINYMCE_SETTINGS,ds:()=>SWIPE_Y_THRESHOLD,kJ:()=>MOBILE_WIDTH});const MOBILE_WIDTH=767,SWIPE_X_THRESHOLD=125,SWIPE_Y_THRESHOLD=150,SCROLL_UP_DISTANCE=500,TINYMCE_SETTINGS={plugins:["advlist","autolink","autosave","lists","link","image","charmap","anchor","searchreplace","visualblocks","media","table","help","wordcount"],toolbar:["restoredraft undo redo | formatselect | bold italic underline strikethrough subscript superscript link unlink blockquote | backcolor forecolor hilitecolor fontsizeselect |","alignleft aligncenter alignright | bullist numlist outdent indent | removeformat | table help"],skin:"oxide-dark",content_css:"dark",browser_spellcheck:!0,menubar:!1,height:500,convert_urls:!1,relative_urls:!1,branding:!1,base_url:"/wiki2/tinymce",suffix:".min",highlight_on_focus:!1}},"./src/app/design/atoms/_models/button.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ap:()=>toButtonClasses,C9:()=>toElementKind,bV:()=>ELEMENT_TYPES});const ELEMENT_TYPES=["PRIMARY","SECONDARY","DARK","DANGER","WARNING","LIGHT","INFO"];function toElementKind(kind){switch(kind){case"PRIMARY":case"SECONDARY":case"DARK":case"DANGER":case"WARNING":case"LIGHT":case"INFO":return kind;case"PRIMARY-OUTLINE":case"SECONDARY-OUTLINE":case"DARK-OUTLINE":case"DANGER-OUTLINE":case"WARNING-OUTLINE":case"LIGHT-OUTLINE":case"INFO-OUTLINE":return kind.replace("-OUTLINE","");case"NONE":return}}const BS_SIZE_CLASS_MAP={SMALL:"btn-sm",MEDIUM:"",LARGE:"btn-lg"},BS_KIND_CLASS_MAP={PRIMARY:"btn-primary",SECONDARY:"btn-secondary",DARK:"btn-dark",DANGER:"btn-danger",WARNING:"btn-warning",LIGHT:"btn-light",INFO:"btn-info","PRIMARY-OUTLINE":"btn-outline-primary","SECONDARY-OUTLINE":"btn-outline-secondary","DARK-OUTLINE":"btn-outline-dark","DANGER-OUTLINE":"btn-outline-danger","WARNING-OUTLINE":"btn-outline-warning","LIGHT-OUTLINE":"btn-outline-light","INFO-OUTLINE":"btn-outline-info",NONE:"btn-none"};function toButtonClasses(kind,size){return`${"NONE"!==kind?"btn":""} ${BS_SIZE_CLASS_MAP[size]} ${BS_KIND_CLASS_MAP[kind]}`}},"./src/app/design/atoms/_models/icon.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{bS:()=>toIconKind,eN:()=>ALL_REGULAR_ICONS,xy:()=>ALL_ICONS,zN:()=>ALL_SOLID_ICONS});const ALL_REGULAR_ICONS=["calendar","circle-user","clock","copy","envelope","hourglass","map","plus-square","user"],REGULAR_ICON_SET=new Set(ALL_REGULAR_ICONS),ALL_SOLID_ICONS=["anchor","arrow-down","arrow-down-long","arrow-left-long","arrow-left","arrow-right-long","arrow-right","arrow-rotate-left","arrow-up","arrow-up-long","bars","ban","bolt","book-open","book","calendar-alt","calendar-day","calendar-week","check","chess-rook","chevron-down","chevron-left","chevron-right","chevron-up","circle","circle-exclamation","clipboard","cog","comments","compass","copy","crown","cut","home","database","desktop","diagram-project","diamond","dice","down-long","download","dragon","dungeon","ellipsis-vertical","exclamation","expand","file-arrow-down","file-audio","file-import","file","file-pen","filter","floppy-disk","gear","gavel","globe-americas","hammer","hand-sparkles","hat-wizard","hand-fist","house","handshake","hotel","hourglass-half","infinity","info-circle","info","location-dot","lock","link","list","magic","male","minus","monument","moon","mountain","newspaper","paw","pen","pencil","place-of-worship","plus","question-circle","rectangle-list","redo-alt","refresh","right-from-bracket","search","sign-out-alt","sitemap","spinner","square-check","store","table","tag","th-list","times","tint","trash","tree","triangle-exclamation","umbrella-beach","university","up-long","up-down-left-right","up-right-from-square","upload","user-cog","user-plus","users-gear","volume-up","water","xmark"],SOLID_ICONS_SET=new Set(ALL_SOLID_ICONS),ALL_BRAND_ICONS=["fort-awesome"],BRAND_ICON_SET=new Set(ALL_BRAND_ICONS),ALL_ICONS=[...ALL_REGULAR_ICONS,...ALL_SOLID_ICONS,...ALL_BRAND_ICONS];function toIconKind(icon){const ico=icon;return SOLID_ICONS_SET.has(ico)?"fa-solid":BRAND_ICON_SET.has(ico)?"fa-brands":REGULAR_ICON_SET.has(ico)?"fa-regular":"fa-solid"}},"./src/app/design/atoms/button/button.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: var(--spacer-1);\n  min-width: 40px;\n  min-height: 40px;\n}\n:host:focus-visible {\n  outline: var(--focus-outline);\n}\n:host :disabled {\n  cursor: not-allowed;\n}\n\n.btn__text--large {\n  font-weight: bold;\n}\n.btn__spinner {\n  margin-left: var(--spacer-2);\n  width: 20px;\n  height: 20px;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/atoms/button/button.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>ButtonComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var button_componentngResource=__webpack_require__("./src/app/design/atoms/button/button.component.scss?ngResource"),button_componentngResource_default=__webpack_require__.n(button_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),_models_button=__webpack_require__("./src/app/design/atoms/_models/button.ts"),icon_component=__webpack_require__("./src/app/design/atoms/icon/icon.component.ts"),spinner_component=__webpack_require__("./src/app/design/atoms/spinner/spinner.component.ts");let ButtonComponent=class ButtonComponent{constructor(){this.kind=core.input.required(),this.text=(0,core.input)(),this.icon=(0,core.input)(),this.size=(0,core.input)("MEDIUM"),this.type=(0,core.input)("button"),this.isLoading=(0,core.input)(!1),this.disabled=(0,core.input)(!1),this.clicked=(0,core.output)(),this.disabledClass=(0,resource_BarKSp_3.EW)(()=>this.disabled()?"disabled":""),this.classes=(0,resource_BarKSp_3.EW)(()=>(0,_models_button.Ap)(this.kind(),this.size())+` ${this.disabledClass()}`)}onClick(event){this.isLoading()||this.disabled()||this.clicked.emit(event)}static#_=this.propDecorators={kind:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"kind",required:!0,transform:void 0}]}],text:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"text",required:!1,transform:void 0}]}],icon:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"icon",required:!1,transform:void 0}]}],size:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"size",required:!1,transform:void 0}]}],type:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"type",required:!1,transform:void 0}]}],isLoading:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"isLoading",required:!1,transform:void 0}]}],disabled:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"disabled",required:!1,transform:void 0}]}],clicked:[{type:debug_node_JnOYh9kg.k7i,args:["clicked"]}]}};ButtonComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"button[btn]",template:'@let iconVal = icon();\n@if (iconVal) {\n  <app-icon [class.btn__icon]="text()" [icon]="iconVal"></app-icon>\n}\n\n@if (text()) {\n  <span\n    class="btn__text"\n    [class.btn__text--large]="size() === \'LARGE\'"\n    [innerHTML]="text()"\n  >\n  </span>\n}\n\n@if (isLoading()) {\n  <app-spinner class="btn__spinner"></app-spinner>\n}\n',changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,imports:[icon_component.R,spinner_component.t],host:{"[class]":"classes()","[type]":"type()","[attr.aria-disabled]":"isLoading() || disabled()","(click)":"onClick($event)"},styles:[button_componentngResource_default()]})],ButtonComponent)},"./src/app/design/atoms/icon/icon.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/atoms/icon/icon.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{R:()=>IconComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var icon_componentngResource=__webpack_require__("./src/app/design/atoms/icon/icon.component.scss?ngResource"),icon_componentngResource_default=__webpack_require__.n(icon_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),resource_BarKSp_3=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),icon=__webpack_require__("./src/app/design/atoms/_models/icon.ts");let IconComponent=class IconComponent{constructor(){this.icon=core.input.required(),this.iconType=(0,resource_BarKSp_3.EW)(()=>(0,icon.bS)(this.icon())),this.classes=(0,resource_BarKSp_3.EW)(()=>this.iconType()?`${this.iconType()} fa-${this.icon()}`:"")}static#_=this.propDecorators={icon:[{type:debug_node_JnOYh9kg.pde,args:[{isSignal:!0,alias:"icon",required:!0,transform:void 0}]}]}};IconComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"app-icon",template:"",changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,imports:[],host:{"[class]":"classes()","aria-hidden":"true"},styles:[icon_componentngResource_default()]})],IconComponent)},"./src/app/design/atoms/spinner/spinner.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  --thickness: var(--bs-body-font-size);\n  font-size: var(--thickness);\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/design/atoms/spinner/spinner.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{t:()=>SpinnerComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var spinner_componentngResource=__webpack_require__("./src/app/design/atoms/spinner/spinner.component.scss?ngResource"),spinner_componentngResource_default=__webpack_require__.n(spinner_componentngResource),debug_node_JnOYh9kg=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs");let SpinnerComponent=class SpinnerComponent{constructor(){this.spinnerBorder=!0}static#_=this.propDecorators={spinnerBorder:[{type:debug_node_JnOYh9kg.g$6,args:["class.spinner-border"]}]}};SpinnerComponent=(0,tslib_es6.Cg)([(0,debug_node_JnOYh9kg.uAl)({selector:"app-spinner",template:"",changeDetection:debug_node_JnOYh9kg.Ngq.OnPush,imports:[],styles:[spinner_componentngResource_default()]})],SpinnerComponent)},"./src/app/design/organisms/toast-overlay/toast.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{f:()=>ToastService});var tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler-DCy1y1b8.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/core/fesm2022/resource-BarKSp_3.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node-JnOYh9kg.mjs"),src_utils_logging__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utils/logging.ts");let ToastService=class ToastService{constructor(){this.toasts=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.vPA)([]),this.currentToast=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.EW)(()=>this.toasts()[0])}addToast(newToast){(0,src_utils_logging__WEBPACK_IMPORTED_MODULE_2__.R)(this.addToast.name,newToast);const toasts=this.toasts();newToast.important?this.toasts.set([newToast,...toasts]):this.toasts.set([...toasts,newToast])}dismissToast(){const[,...newToastList]=this.toasts();this.toasts.set(newToastList)}};ToastService=(0,tslib__WEBPACK_IMPORTED_MODULE_3__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__._qm)({providedIn:"root"})],ToastService)},"./src/environments/environment.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>environment});const environment={kind:"PRODUCTION",apiUrl:"/wiki1/api",configUrl:"/wiki1/feature_config.json"}},"./src/utils/clipboard.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function copyToClipboard(text){const windowSelection=window.getSelection(),documentSelection=window.getSelection();let userSelectedTextRange;(function userHasElementsSelected(){const selection=document.getSelection();if(null==selection)return!1;return selection?.rangeCount>0})()&&(userSelectedTextRange=documentSelection.getRangeAt(0),windowSelection.removeRange(userSelectedTextRange));const textContainerElement=function createTextContainerElement(text){const textContainerElement=document.createElement("div");textContainerElement.innerHTML=text;const strippedText=textContainerElement.textContent;return textContainerElement.innerHTML=strippedText.replaceAll(">","<br>> ").slice(4),textContainerElement.style.position="absolute",textContainerElement.style.left="-9999px",textContainerElement}(text);document.body.appendChild(textContainerElement);const copyRange=function selectElement(element){const selectedRange=document.createRange();return selectedRange.selectNode(element),window.getSelection()?.addRange(selectedRange),selectedRange}(textContainerElement);!function copyCurrentSelection(){try{document.execCommand("copy")}catch(err){window.alert("Your Browser Doesn't support this! Error : "+err)}}(),windowSelection.removeRange(copyRange),document.body.removeChild(textContainerElement),userSelectedTextRange&&windowSelection.addRange(userSelectedTextRange)}__webpack_require__.d(__webpack_exports__,{l:()=>copyToClipboard})},"./src/utils/rxjs-operators.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{cY:()=>debugLog,fC:()=>delayFalsy,u5:()=>filterNil});var rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/pipe.js"),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),rxjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/delay.js"),src_environments_environment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/environments/environment.ts"),_logging__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/utils/logging.ts");function filterNil(){return(0,rxjs__WEBPACK_IMPORTED_MODULE_1__.p)(x=>null!=x)}const debugLog=debugSymbol=>{const isDevelop="DEVELOPMENT"===src_environments_environment__WEBPACK_IMPORTED_MODULE_0__.c.kind;return(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.M)(x=>{isDevelop&&(0,_logging__WEBPACK_IMPORTED_MODULE_3__.R)(debugSymbol,x)})};function delayFalsy(delayByMs=1e3){return(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.F)((0,rxjs__WEBPACK_IMPORTED_MODULE_5__.n)(x=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)(x).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_7__.c)(x?0:delayByMs))))}},"./src/utils/store/withQueries/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{j:()=>withQueries});var ngrx_operators=__webpack_require__("./node_modules/@ngrx/operators/fesm2022/ngrx-operators.mjs"),ngrx_signals=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals.mjs"),ngrx_signals_rxjs_interop=__webpack_require__("./node_modules/@ngrx/signals/fesm2022/ngrx-signals-rxjs-interop.mjs"),pipe=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/pipe.js"),tap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js"),switchMap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),string=__webpack_require__("./src/utils/string.ts");function getKeys(name){return{name,dataField:(0,string.YF)(name),errorField:`${(0,string.YF)(name)}Error`,queryStateField:`${(0,string.YF)(name)}QueryState`,loadMethod:`load${(0,string.ZH)(name)}`}}function withQueries(queriesFactory){return store=>{const queries=queriesFactory({...store.stateSignals,...store.props,...store.methods}),storeWithState=function withQueriesState(queries){return(0,ngrx_signals.Mj)((0,ngrx_signals.Q2)(()=>Object.keys(queries).map(queryName=>getKeys(queryName)).map(keys=>({[keys.dataField]:void 0,[keys.errorField]:void 0,[keys.queryStateField]:"init"})).reduce((acc,RequestState)=>({...acc,...RequestState}),{})))}(queries)(store);return function withQueryMethods(queries){return(0,ngrx_signals.Mj)((0,ngrx_signals.RI)(store=>Object.keys(queries).map(queryName=>getKeys(queryName)).map(keys=>({[keys.loadMethod]:(0,ngrx_signals_rxjs_interop.o)((0,pipe.F)((0,tap.M)(()=>(0,ngrx_signals.M8)(store,{[keys.queryStateField]:"loading",[keys.errorField]:void 0})),(0,switchMap.n)(params=>queries[keys.name](params)),(0,ngrx_operators.Hn)({next:val=>(0,ngrx_signals.M8)(store,{[keys.dataField]:val,[keys.queryStateField]:"success"}),error:err=>{(0,ngrx_signals.M8)(store,{[keys.errorField]:err,[keys.queryStateField]:"error"})}})))})).reduce((acc,queryLoadFunction)=>({...acc,...queryLoadFunction}),{})))}(queries)(storeWithState)}}}}]);